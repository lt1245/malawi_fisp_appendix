#include("setup.jl")
##########################################################################################################################################################
##
##  RESULTS FOR ANALYSIS:
## #! indicates unsolved/inaccurate results
##########################################################################################################################################################

# Details from the initial steady state - evaluate from here if want to obtain only the results
foreign_supply_capital_subsidy_b = 7.631597488627073;
#No subsidy equilibrium
prices_no_subsidy = [ 1.188283177632008,
0.18349666252335484];
No_subsidy_parameter = copy(Baseline_parameter);
No_subsidy_parameter.τ_S=-0;
(residual_goods_no_subsidy, stat_distr_no_subsidy, cons_fine_local_no_subsidy, a_prime_fine_local_no_subsidy,future_occupation_fine_local_no_subsidy,x_S_S_fine_no_subsidy,x_SC_fine_no_subsidy,x_BC_fine_no_subsidy, coeff_no_subsidy,
transaction_cost_loss_no_subsidy,nominal_GDP_no_subsidy,welfare_val_no_subsidy,Import_value_no_subsidy,Export_value_no_subsidy,current_worker_pop_no_subsidy,current_staple_pop_no_subsidy,current_cashcrop_pop_no_subsidy,
marketable_agr_surplus_share_no_subsidy,exportshare_cashcrop_no_subsidy,
fraction_model_no_subsidy,program_spending_no_subsidy,prod_value_improvement_no_subsidy,share_selling_increase_no_subsidy,exp_ratio_model_no_subsidy,mig_rate_model_no_subsidy,rural_pop_only_staples_model_no_subsidy,rural_pop_only_cashcrop_model_no_subsidy,
mean_land_share_to_staples_among_cc_model_no_subsidy,urban_rural_inc_ratio_model_no_subsidy,urban_rural_wealth_ratio_model_no_subsidy,urban_rural_consumption_ratio_model_no_subsidy,
p90_wealth_rural_no_subsidy,p90_wealth_urban_no_subsidy,p99_wealth_rural_no_subsidy,p99_wealth_urban_no_subsidy,p90_cons_tmp_no_subsidy,p90_income_tmp_no_subsidy,p99_cons_tmp_no_subsidy,p99_income_tmp_no_subsidy,
staple_productivity_no_subsidy,cashcrop_productivity_no_subsidy,manuf_productivity_no_subsidy,relative_land_to_staples_no_subsidy,relative_land_to_cashcrop_no_subsidy,share_constrained_cashcrop_no_subsidy,var_MPX_staples_S_no_subsidy,var_MPX_cashcrop_B_no_subsidy,var_MPX_cashcrop_S_no_subsidy,
share_constrained_staple_no_subsidy,APG_no_subsidy,urban_rural_consumption_ratio_model_real_no_subsidy,aggregate_consumption_no_subsidy,
worker_pop_effective_no_subsidy,prod_manuf_no_subsidy,total_entry_cost_no_subsidy,prod_staple_no_subsidy,prod_cashcrop_no_subsidy,input_staple_no_subsidy,input_cashcrop_no_subsidy,total_maintenance_cost_no_subsidy,
current_account_residual_no_subsidy,fraction_cashcrop_suboptimal_model_no_subsidy,V_saved_no_subsidy
,avg_labor_prod_rural_no_subsidy,avg_labor_prod_urban_no_subsidy,avg_agri_prod_rural_no_subsidy,avg_agri_prod_urban_no_subsidy
,var_MPX_cashcrop_no_subsidy,var_MPX_no_subsidy,TFP_no_subsidy,YL_manuf_no_subsidy , YL_agr_no_subsidy,coeff_var_labor_prod_rural_no_subsidy,coeff_var_labor_prod_urban_no_subsidy,coeff_var_agri_prod_rural_no_subsidy, coeff_var_agri_prod_urban_no_subsidy
,p90_wealth_no_subsidy,p99_wealth_no_subsidy,p90_cons_no_subsidy_rural,p99_cons_no_subsidy_rural,p90_cons_no_subsidy_urban,p99_cons_no_subsidy_urban,p90_income_no_subsidy_rural,
p99_income_no_subsidy_rural,p90_income_no_subsidy_urban,p99_income_no_subsidy_urban,wealth_of_workers_no_subsidy,wealth_of_staples_no_subsidy,wealth_of_cashcrop_no_subsidy
,c_B_worker_sum_no_subsidy,c_B_staple_sum_no_subsidy,c_B_cashcrop_sum_no_subsidy,c_S_worker_sum_no_subsidy,c_S_staple_sum_no_subsidy ,c_S_cashcrop_sum_no_subsidy,
transaction_cost_staple_sum_no_subsidy,transaction_cost_cashcrop_sum_no_subsidy,transaction_cost_worker_sum_no_subsidy,c_M_worker_sum_no_subsidy,c_M_staple_sum_no_subsidy,c_M_cashcrop_sum_no_subsidy,
MPX_mean_log_no_subsidy, MPX_mean_staples_S_log_no_subsidy,MPX_mean_cashcrop_log_no_subsidy
, APland_mean_log_no_subsidy,APland_mean_cashcrop_log_no_subsidy, APland_mean_staples_S_log_no_subsidy,var_APland_no_subsidy,var_APland_cashcrop_no_subsidy,var_APland_staples_S_no_subsidy,
c_S_W_fine_no_subsidy,c_B_W_fine_no_subsidy,c_M_W_fine_no_subsidy,c_S_S_fine_no_subsidy,c_B_S_fine_no_subsidy,c_M_S_fine_no_subsidy,c_S_B_fine_no_subsidy,c_B_B_fine_no_subsidy,c_M_B_fine_no_subsidy) = details_model(prices_no_subsidy,No_subsidy_parameter,2,moments,0.0,foreign_supply_capital_subsidy_b);

#No cbar QS + no subsidy equilibrium
prices_no_cbarQS_no_subsidy = [ 1.1965420095105022,
0.1658018507502125];
no_cbarQS_no_subsidy_parameter = copy(Baseline_parameter);
no_cbarQS_no_subsidy_parameter.τ_S=-0;
no_cbarQS_no_subsidy_parameter.Q_S=0;
no_cbarQS_no_subsidy_parameter.c̄_S=0.0;
(residual_goods_no_cbarQS_no_subsidy, stat_distr_no_cbarQS_no_subsidy, cons_fine_local_no_cbarQS_no_subsidy, a_prime_fine_local_no_cbarQS_no_subsidy,future_occupation_fine_local_no_cbarQS_no_subsidy,x_S_S_fine_no_cbarQS_no_subsidy,x_SC_fine_no_cbarQS_no_subsidy,x_BC_fine_no_cbarQS_no_subsidy, coeff_no_cbarQS_no_subsidy,
transaction_cost_loss_no_cbarQS_no_subsidy,nominal_GDP_no_cbarQS_no_subsidy,welfare_val_no_cbarQS_no_subsidy,Import_value_no_cbarQS_no_subsidy,Export_value_no_cbarQS_no_subsidy,current_worker_pop_no_cbarQS_no_subsidy,current_staple_pop_no_cbarQS_no_subsidy,current_cashcrop_pop_no_cbarQS_no_subsidy,
marketable_agr_surplus_share_no_cbarQS_no_subsidy,exportshare_cashcrop_no_cbarQS_no_subsidy,
fraction_model_no_cbarQS_no_subsidy,program_spending_no_cbarQS_no_subsidy,prod_value_improvement_no_cbarQS_no_subsidy,share_selling_increase_no_cbarQS_no_subsidy,exp_ratio_model_no_cbarQS_no_subsidy,mig_rate_model_no_cbarQS_no_subsidy,rural_pop_only_staples_model_no_cbarQS_no_subsidy,rural_pop_only_cashcrop_model_no_cbarQS_no_subsidy,
mean_land_share_to_staples_among_cc_model_no_cbarQS_no_subsidy,urban_rural_inc_ratio_model_no_cbarQS_no_subsidy,urban_rural_wealth_ratio_model_no_cbarQS_no_subsidy,urban_rural_consumption_ratio_model_no_cbarQS_no_subsidy,
p90_wealth_rural_no_cbarQS_no_subsidy,p90_wealth_urban_no_cbarQS_no_subsidy,p99_wealth_rural_no_cbarQS_no_subsidy,p99_wealth_urban_no_cbarQS_no_subsidy,p90_cons_tmp_no_cbarQS_no_subsidy,p90_income_tmp_no_cbarQS_no_subsidy,p99_cons_tmp_no_cbarQS_no_subsidy,p99_income_tmp_no_cbarQS_no_subsidy,
staple_productivity_no_cbarQS_no_subsidy,cashcrop_productivity_no_cbarQS_no_subsidy,manuf_productivity_no_cbarQS_no_subsidy,relative_land_to_staples_no_cbarQS_no_subsidy,relative_land_to_cashcrop_no_cbarQS_no_subsidy,share_constrained_cashcrop_no_cbarQS_no_subsidy,var_MPX_staples_S_no_cbarQS_no_subsidy,var_MPX_cashcrop_B_no_cbarQS_no_subsidy,var_MPX_cashcrop_S_no_cbarQS_no_subsidy,
share_constrained_staple_no_cbarQS_no_subsidy,APG_no_cbarQS_no_subsidy,urban_rural_consumption_ratio_model_real_no_cbarQS_no_subsidy,aggregate_consumption_no_cbarQS_no_subsidy,
worker_pop_effective_no_cbarQS_no_subsidy,prod_manuf_no_cbarQS_no_subsidy,total_entry_cost_no_cbarQS_no_subsidy,prod_staple_no_cbarQS_no_subsidy,prod_cashcrop_no_cbarQS_no_subsidy,input_staple_no_cbarQS_no_subsidy,input_cashcrop_no_cbarQS_no_subsidy,total_maintenance_cost_no_cbarQS_no_subsidy,
current_account_residual_no_cbarQS_no_subsidy,fraction_cashcrop_suboptimal_model_no_cbarQS_no_subsidy,V_saved_no_cbarQS_no_subsidy,avg_labor_prod_rural_no_cbarQS_no_subsidy,
avg_labor_prod_urban_no_cbarQS_no_subsidy,avg_agri_prod_rural_no_cbarQS_no_subsidy,avg_agri_prod_urban_no_cbarQS_no_subsidy,
var_MPX_cashcrop_no_cbarQS_no_subsidy,var_MPX_no_cbarQS_no_subsidy,TFP_no_cbarQS_no_subsidy,YL_manuf_no_cbarQS_no_subsidy , YL_agr_no_cbarQS_no_subsidy,coeff_var_labor_prod_rural_no_cbarQS_no_subsidy,coeff_var_labor_prod_urban_no_cbarQS_no_subsidy,coeff_var_agri_prod_rural_no_cbarQS_no_subsidy, coeff_var_agri_prod_urban_no_cbarQS_no_subsidy,
p90_wealth_no_cbarQS_no_subsidy,p99_wealth_no_cbarQS_no_subsidy,p90_cons_no_cbarQS_no_subsidy_rural,p99_cons_no_cbarQS_no_subsidy_rural,p90_cons_no_cbarQS_no_subsidy_urban,p99_cons_no_cbarQS_no_subsidy_urban,p90_income_no_cbarQS_no_subsidy_rural,
p99_income_no_cbarQS_no_subsidy_rural,p90_income_no_cbarQS_no_subsidy_urban,p99_income_no_cbarQS_no_subsidy_urban,wealth_of_workers_no_cbarQS_no_subsidy,wealth_of_staples_no_cbarQS_no_subsidy,wealth_of_cashcrop_no_cbarQS_no_subsidy,
c_B_worker_sum_no_cbarQS_no_subsidy,c_B_staple_sum_no_cbarQS_no_subsidy,c_B_cashcrop_sum_no_cbarQS_no_subsidy,c_S_worker_sum_no_cbarQS_no_subsidy,c_S_staple_sum_no_cbarQS_no_subsidy ,c_S_cashcrop_sum_no_cbarQS_no_subsidy,
transaction_cost_staple_sum_no_cbarQS_no_subsidy,transaction_cost_cashcrop_sum_no_cbarQS_no_subsidy,transaction_cost_worker_sum_no_cbarQS_no_subsidy,c_M_worker_sum_no_cbarQS_no_subsidy,c_M_staple_sum_no_cbarQS_no_subsidy,c_M_cashcrop_sum_no_cbarQS_no_subsidy,
MPX_mean_log_no_cbarQS_no_subsidy, MPX_mean_staples_S_log_no_cbarQS_no_subsidy,MPX_mean_cashcrop_log_no_cbarQS_no_subsidy
, APland_mean_log_no_cbarQS_no_subsidy,APland_mean_cashcrop_log_no_cbarQS_no_subsidy, APland_mean_staples_S_log_no_cbarQS_no_subsidy,var_APland_no_cbarQS_no_subsidy,var_APland_cashcrop_no_cbarQS_no_subsidy,var_APland_staples_S_no_cbarQS_no_subsidy,
c_S_W_fine_no_cbarQS_no_subsidy,c_B_W_fine_no_cbarQS_no_subsidy,c_M_W_fine_no_cbarQS_no_subsidy,c_S_S_fine_no_cbarQS_no_subsidy,c_B_S_fine_no_cbarQS_no_subsidy,c_M_S_fine_no_cbarQS_no_subsidy,c_S_B_fine_no_cbarQS_no_subsidy,c_B_B_fine_no_cbarQS_no_subsidy,c_M_B_fine_no_cbarQS_no_subsidy) = details_model(prices_no_cbarQS_no_subsidy,no_cbarQS_no_subsidy_parameter,2,moments,0.0,foreign_supply_capital_subsidy_b);



#No cbar + no subsidy equilibrium
prices_no_cbar_no_subsidy = [   1.205937339361828,
0.18357263199475019];
no_cbar_no_subsidy_parameter = copy(Baseline_parameter);
no_cbar_no_subsidy_parameter.τ_S=-0;
no_cbar_no_subsidy_parameter.c̄_S=0.0;

(residual_goods_no_cbar_no_subsidy, stat_distr_no_cbar_no_subsidy, cons_fine_local_no_cbar_no_subsidy, a_prime_fine_local_no_cbar_no_subsidy,future_occupation_fine_local_no_cbar_no_subsidy,x_S_S_fine_no_cbar_no_subsidy,x_SC_fine_no_cbar_no_subsidy,x_BC_fine_no_cbar_no_subsidy, coeff_no_cbar_no_subsidy,
transaction_cost_loss_no_cbar_no_subsidy,nominal_GDP_no_cbar_no_subsidy,welfare_val_no_cbar_no_subsidy,Import_value_no_cbar_no_subsidy,Export_value_no_cbar_no_subsidy,current_worker_pop_no_cbar_no_subsidy,current_staple_pop_no_cbar_no_subsidy,current_cashcrop_pop_no_cbar_no_subsidy,
marketable_agr_surplus_share_no_cbar_no_subsidy,exportshare_cashcrop_no_cbar_no_subsidy,
fraction_model_no_cbar_no_subsidy,program_spending_no_cbar_no_subsidy,prod_value_improvement_no_cbar_no_subsidy,share_selling_increase_no_cbar_no_subsidy,exp_ratio_model_no_cbar_no_subsidy,mig_rate_model_no_cbar_no_subsidy,rural_pop_only_staples_model_no_cbar_no_subsidy,rural_pop_only_cashcrop_model_no_cbar_no_subsidy,
mean_land_share_to_staples_among_cc_model_no_cbar_no_subsidy,urban_rural_inc_ratio_model_no_cbar_no_subsidy,urban_rural_wealth_ratio_model_no_cbar_no_subsidy,urban_rural_consumption_ratio_model_no_cbar_no_subsidy,
p90_wealth_rural_no_cbar_no_subsidy,p90_wealth_urban_no_cbar_no_subsidy,p99_wealth_rural_no_cbar_no_subsidy,p99_wealth_urban_no_cbar_no_subsidy,p90_cons_tmp_no_cbar_no_subsidy,p90_income_tmp_no_cbar_no_subsidy,p99_cons_tmp_no_cbar_no_subsidy,p99_income_tmp_no_cbar_no_subsidy,
staple_productivity_no_cbar_no_subsidy,cashcrop_productivity_no_cbar_no_subsidy,manuf_productivity_no_cbar_no_subsidy,relative_land_to_staples_no_cbar_no_subsidy,relative_land_to_cashcrop_no_cbar_no_subsidy,share_constrained_cashcrop_no_cbar_no_subsidy,var_MPX_staples_S_no_cbar_no_subsidy,var_MPX_cashcrop_B_no_cbar_no_subsidy,var_MPX_cashcrop_S_no_cbar_no_subsidy,
share_constrained_staple_no_cbar_no_subsidy,APG_no_cbar_no_subsidy,urban_rural_consumption_ratio_model_real_no_cbar_no_subsidy,aggregate_consumption_no_cbar_no_subsidy,
worker_pop_effective_no_cbar_no_subsidy,prod_manuf_no_cbar_no_subsidy,total_entry_cost_no_cbar_no_subsidy,prod_staple_no_cbar_no_subsidy,prod_cashcrop_no_cbar_no_subsidy,input_staple_no_cbar_no_subsidy,input_cashcrop_no_cbar_no_subsidy,total_maintenance_cost_no_cbar_no_subsidy,
current_account_residual_no_cbar_no_subsidy,fraction_cashcrop_suboptimal_model_no_cbar_no_subsidy,V_saved_no_cbar_no_subsidy,avg_labor_prod_rural_no_cbar_no_subsidy 
,avg_labor_prod_urban_no_cbar_no_subsidy ,avg_agri_prod_rural_no_cbar_no_subsidy ,avg_agri_prod_urban_no_cbar_no_subsidy
,var_MPX_cashcrop_no_cbar_no_subsidy,var_MPX_no_cbar_no_subsidy,TFP_no_cbar_no_subsidy,YL_manuf_no_cbar_no_subsidy , YL_agr_no_cbar_no_subsidy,coeff_var_labor_prod_rural_no_cbar_no_subsidy,coeff_var_labor_prod_urban_no_cbar_no_subsidy,coeff_var_agri_prod_rural_no_cbar_no_subsidy, coeff_var_agri_prod_urban_no_cbar_no_subsidy,
p90_wealth_no_cbar_no_subsidy,p99_wealth_no_cbar_no_subsidy,p90_cons_no_cbar_no_subsidy_rural,p99_cons_no_cbar_no_subsidy_rural,p90_cons_no_cbar_no_subsidy_urban,p99_cons_no_cbar_no_subsidy_urban,p90_income_no_cbar_no_subsidy_rural,
p99_income_no_cbar_no_subsidy_rural,p90_income_no_cbar_no_subsidy_urban,p99_income_no_cbar_no_subsidy_urban,wealth_of_workers_no_cbar_no_subsidy
,wealth_of_staples_no_cbar_no_subsidy,wealth_of_cashcrop_no_cbar_no_subsidy,
c_B_worker_sum_no_cbar_no_subsidy,c_B_staple_sum_no_cbar_no_subsidy,c_B_cashcrop_sum_no_cbar_no_subsidy,c_S_worker_sum_no_cbar_no_subsidy,c_S_staple_sum_no_cbar_no_subsidy ,c_S_cashcrop_sum_no_cbar_no_subsidy,
transaction_cost_staple_sum_no_cbar_no_subsidy,transaction_cost_cashcrop_sum_no_cbar_no_subsidy,transaction_cost_worker_sum_no_cbar_no_subsidy,c_M_worker_sum_no_cbar_no_subsidy,c_M_staple_sum_no_cbar_no_subsidy,c_M_cashcrop_sum_no_cbar_no_subsidy,
MPX_mean_log_no_cbar_no_subsidy, MPX_mean_staples_S_log_no_cbar_no_subsidy,MPX_mean_cashcrop_log_no_cbar_no_subsidy
, APland_mean_log_no_cbar_no_subsidy,APland_mean_cashcrop_log_no_cbar_no_subsidy, APland_mean_staples_S_log_no_cbar_no_subsidy,var_APland_no_cbar_no_subsidy,var_APland_cashcrop_no_cbar_no_subsidy,var_APland_staples_S_no_cbar_no_subsidy,
c_S_W_fine_no_cbar_no_subsidy,c_B_W_fine_no_cbar_no_subsidy,c_M_W_fine_no_cbar_no_subsidy,c_S_S_fine_no_cbar_no_subsidy,c_B_S_fine_no_cbar_no_subsidy,c_M_S_fine_no_cbar_no_subsidy,c_S_B_fine_no_cbar_no_subsidy,c_B_B_fine_no_cbar_no_subsidy,c_M_B_fine_no_cbar_no_subsidy) = details_model(prices_no_cbar_no_subsidy,no_cbar_no_subsidy_parameter,2,moments,0.0,foreign_supply_capital_subsidy_b);

#No QS + no subsidy equilibrium
prices_no_QS_no_subsidy = [  1.186049115293932,
0.1641263316802302]
no_QS_no_subsidy_parameter = copy(Baseline_parameter);
no_QS_no_subsidy_parameter.τ_S=-0;
no_QS_no_subsidy_parameter.Q_S=0;

(residual_goods_no_QS_no_subsidy, stat_distr_no_QS_no_subsidy, cons_fine_local_no_QS_no_subsidy, a_prime_fine_local_no_QS_no_subsidy,future_occupation_fine_local_no_QS_no_subsidy,x_S_S_fine_no_QS_no_subsidy,x_SC_fine_no_QS_no_subsidy,x_BC_fine_no_QS_no_subsidy, coeff_no_QS_no_subsidy,
transaction_cost_loss_no_QS_no_subsidy,nominal_GDP_no_QS_no_subsidy,welfare_val_no_QS_no_subsidy,Import_value_no_QS_no_subsidy,Export_value_no_QS_no_subsidy,current_worker_pop_no_QS_no_subsidy,current_staple_pop_no_QS_no_subsidy,current_cashcrop_pop_no_QS_no_subsidy,
marketable_agr_surplus_share_no_QS_no_subsidy,exportshare_cashcrop_no_QS_no_subsidy,
fraction_model_no_QS_no_subsidy,program_spending_no_QS_no_subsidy,prod_value_improvement_no_QS_no_subsidy,share_selling_increase_no_QS_no_subsidy,exp_ratio_model_no_QS_no_subsidy,mig_rate_model_no_QS_no_subsidy,rural_pop_only_staples_model_no_QS_no_subsidy,rural_pop_only_cashcrop_model_no_QS_no_subsidy,
mean_land_share_to_staples_among_cc_model_no_QS_no_subsidy,urban_rural_inc_ratio_model_no_QS_no_subsidy,urban_rural_wealth_ratio_model_no_QS_no_subsidy,urban_rural_consumption_ratio_model_no_QS_no_subsidy,
p90_wealth_rural_no_QS_no_subsidy,p90_wealth_urban_no_QS_no_subsidy,p99_wealth_rural_no_QS_no_subsidy,p99_wealth_urban_no_QS_no_subsidy,p90_cons_tmp_no_QS_no_subsidy,p90_income_tmp_no_QS_no_subsidy,p99_cons_tmp_no_QS_no_subsidy,p99_income_tmp_no_QS_no_subsidy,
staple_productivity_no_QS_no_subsidy,cashcrop_productivity_no_QS_no_subsidy,manuf_productivity_no_QS_no_subsidy,relative_land_to_staples_no_QS_no_subsidy,relative_land_to_cashcrop_no_QS_no_subsidy,share_constrained_cashcrop_no_QS_no_subsidy,var_MPX_staples_S_no_QS_no_subsidy,var_MPX_cashcrop_B_no_QS_no_subsidy,var_MPX_cashcrop_S_no_QS_no_subsidy,
share_constrained_staple_no_QS_no_subsidy,APG_no_QS_no_subsidy,urban_rural_consumption_ratio_model_real_no_QS_no_subsidy,aggregate_consumption_no_QS_no_subsidy,
worker_pop_effective_no_QS_no_subsidy,prod_manuf_no_QS_no_subsidy,total_entry_cost_no_QS_no_subsidy,prod_staple_no_QS_no_subsidy,prod_cashcrop_no_QS_no_subsidy,input_staple_no_QS_no_subsidy,input_cashcrop_no_QS_no_subsidy,total_maintenance_cost_no_QS_no_subsidy,
current_account_residual_no_QS_no_subsidy,fraction_cashcrop_suboptimal_model_no_QS_no_subsidy,V_saved_no_QS_no_subsidy
,avg_labor_prod_rural_no_QS_no_subsidy,avg_labor_prod_urban_no_QS_no_subsidy,avg_agri_prod_rural_no_QS_no_subsidy,avg_agri_prod_urban_no_QS_no_subsidy
,var_MPX_cashcrop_no_QS_no_subsidy,var_MPX_no_QS_no_subsidy,TFP_no_QS_no_subsidy,YL_manuf_no_QS_no_subsidy , YL_agr_no_QS_no_subsidy,coeff_var_labor_prod_rural_no_QS_no_subsidy,coeff_var_labor_prod_urban_no_QS_no_subsidy,coeff_var_agri_prod_rural_no_QS_no_subsidy, coeff_var_agri_prod_urban_no_QS_no_subsidy,
p90_wealth_no_QS_no_subsidy,p99_wealth_no_QS_no_subsidy,p90_cons_no_QS_no_subsidy_rural,p99_cons_no_QS_no_subsidy_rural,p90_cons_no_QS_no_subsidy_urban,p99_cons_no_QS_no_subsidy_urban,p90_income_no_QS_no_subsidy_rural,
p99_income_no_QS_no_subsidy_rural,p90_income_no_QS_no_subsidy_urban,p99_income_no_QS_no_subsidy_urban,
wealth_of_workers_no_QS_no_subsidy,wealth_of_staples_no_QS_no_subsidy,wealth_of_cashcrop_no_QS_no_subsidy,
c_B_worker_sum_no_QS_no_subsidy,c_B_staple_sum_no_QS_no_subsidy,c_B_cashcrop_sum_no_QS_no_subsidy,c_S_worker_sum_no_QS_no_subsidy,c_S_staple_sum_no_QS_no_subsidy ,c_S_cashcrop_sum_no_QS_no_subsidy,
transaction_cost_staple_sum_no_QS_no_subsidy,transaction_cost_cashcrop_sum_no_QS_no_subsidy,transaction_cost_worker_sum_no_QS_no_subsidy,c_M_worker_sum_no_QS_no_subsidy,c_M_staple_sum_no_QS_no_subsidy,c_M_cashcrop_sum_no_QS_no_subsidy,
MPX_mean_log_no_QS_no_subsidy, MPX_mean_staples_S_log_no_QS_no_subsidy,MPX_mean_cashcrop_log_no_QS_no_subsidy
, APland_mean_log_no_QS_no_subsidy,APland_mean_cashcrop_log_no_QS_no_subsidy, APland_mean_staples_S_log_no_QS_no_subsidy,var_APland_no_QS_no_subsidy,var_APland_cashcrop_no_QS_no_subsidy,var_APland_staples_S_no_QS_no_subsidy,
c_S_W_fine_no_QS_no_subsidy,c_B_W_fine_no_QS_no_subsidy,c_M_W_fine_no_QS_no_subsidy,c_S_S_fine_no_QS_no_subsidy,c_B_S_fine_no_QS_no_subsidy,c_M_S_fine_no_QS_no_subsidy,c_S_B_fine_no_QS_no_subsidy,c_B_B_fine_no_QS_no_subsidy,c_M_B_fine_no_QS_no_subsidy) = details_model(prices_no_QS_no_subsidy,no_QS_no_subsidy_parameter,2,moments,0.0,foreign_supply_capital_subsidy_b);



#    No subsidy equilibrium + No F_W
prices_no_F_W_no_subsidy = [ 1.1678794680674407,
0.09092347139175247];#!
no_F_W_no_subsidy_parameter = copy(Baseline_parameter);
no_F_W_no_subsidy_parameter.F_W= 0.0;
no_F_W_no_subsidy_parameter.τ_S=-0.0;
(residual_goods_no_F_W_no_subsidy, stat_distr_no_F_W_no_subsidy, cons_fine_local_no_F_W_no_subsidy, a_prime_fine_local_no_F_W_no_subsidy,future_occupation_fine_local_no_F_W_no_subsidy,x_S_S_fine_no_F_W_no_subsidy,x_SC_fine_no_F_W_no_subsidy,x_BC_fine_no_F_W_no_subsidy, coeff_no_F_W_no_subsidy,
transaction_cost_loss_no_F_W_no_subsidy,nominal_GDP_no_F_W_no_subsidy,welfare_val_no_F_W_no_subsidy,Import_value_no_F_W_no_subsidy,Export_value_no_F_W_no_subsidy,current_worker_pop_no_F_W_no_subsidy,current_staple_pop_no_F_W_no_subsidy,current_cashcrop_pop_no_F_W_no_subsidy,
marketable_agr_surplus_share_no_F_W_no_subsidy,exportshare_cashcrop_no_F_W_no_subsidy,
fraction_model_no_F_W_no_subsidy,program_spending_no_F_W_no_subsidy,prod_value_improvement_no_F_W_no_subsidy,share_selling_increase_no_F_W_no_subsidy,exp_ratio_model_no_F_W_no_subsidy,mig_rate_model_no_F_W_no_subsidy,rural_pop_only_staples_model_no_F_W_no_subsidy,rural_pop_only_cashcrop_model_no_F_W_no_subsidy,
mean_land_share_to_staples_among_cc_model_no_F_W_no_subsidy,urban_rural_inc_ratio_model_no_F_W_no_subsidy,urban_rural_wealth_ratio_model_no_F_W_no_subsidy,urban_rural_consumption_ratio_model_no_F_W_no_subsidy,
p90_wealth_rural_no_F_W_no_subsidy,p90_wealth_urban_no_F_W_no_subsidy,p99_wealth_rural_no_F_W_no_subsidy,p99_wealth_urban_no_F_W_no_subsidy,p90_cons_tmp_no_F_W_no_subsidy,p90_income_tmp_no_F_W_no_subsidy,p99_cons_tmp_no_F_W_no_subsidy,p99_income_tmp_no_F_W_no_subsidy,
staple_productivity_no_F_W_no_subsidy,cashcrop_productivity_no_F_W_no_subsidy,manuf_productivity_no_F_W_no_subsidy,relative_land_to_staples_no_F_W_no_subsidy,relative_land_to_cashcrop_no_F_W_no_subsidy,share_constrained_cashcrop_no_F_W_no_subsidy,var_MPX_staples_S_no_F_W_no_subsidy,var_MPX_cashcrop_B_no_F_W_no_subsidy,var_MPX_cashcrop_S_no_F_W_no_subsidy,
share_constrained_staple_no_F_W_no_subsidy,APG_no_F_W_no_subsidy,urban_rural_consumption_ratio_model_real_no_F_W_no_subsidy,aggregate_consumption_no_F_W_no_subsidy,
worker_pop_effective_no_F_W_no_subsidy,prod_manuf_no_F_W_no_subsidy,total_entry_cost_no_F_W_no_subsidy,prod_staple_no_F_W_no_subsidy,prod_cashcrop_no_F_W_no_subsidy,input_staple_no_F_W_no_subsidy,input_cashcrop_no_F_W_no_subsidy,
total_maintenance_cost_no_F_W_no_subsidy,current_account_residual_no_F_W_no_subsidy,fraction_cashcrop_suboptimal_model_no_F_W_no_subsidy,V_saved_no_F_W_no_subsidy
,avg_labor_prod_rural_no_F_W_no_subsidy,avg_labor_prod_urban_no_F_W_no_subsidy,avg_agri_prod_rural_no_F_W_no_subsidy,avg_agri_prod_urban_no_F_W_no_subsidy
,var_MPX_cashcrop_no_F_W_no_subsidy,var_MPX_no_F_W_no_subsidy,TFP_no_F_W_no_subsidy,YL_manuf_no_F_W_no_subsidy , YL_agr_no_F_W_no_subsidy,coeff_var_labor_prod_rural_no_F_W_no_subsidy,coeff_var_labor_prod_urban_no_F_W_no_subsidy,coeff_var_agri_prod_rural_no_F_W_no_subsidy, coeff_var_agri_prod_urban_no_F_W_no_subsidy,
p90_wealth_no_F_W_no_subsidy,p99_wealth_no_F_W_no_subsidy,p90_cons_no_F_W_no_subsidy_rural,p99_cons_no_F_W_no_subsidy_rural,p90_cons_no_F_W_no_subsidy_urban,p99_cons_no_F_W_no_subsidy_urban,p90_income_no_F_W_no_subsidy_rural,
p99_income_no_F_W_no_subsidy_rural,p90_income_no_F_W_no_subsidy_urban,p99_income_no_F_W_no_subsidy_urban,
wealth_of_workers_no_F_W_no_subsidy,wealth_of_staples_no_F_W_no_subsidy,wealth_of_cashcrop_no_F_W_no_subsidy,
c_B_worker_sum_no_F_W_no_subsidy,c_B_staple_sum_no_F_W_no_subsidy,c_B_cashcrop_sum_no_F_W_no_subsidy,c_S_worker_sum_no_F_W_no_subsidy,c_S_staple_sum_no_F_W_no_subsidy ,c_S_cashcrop_sum_no_F_W_no_subsidy,
transaction_cost_staple_sum_no_F_W_no_subsidy,transaction_cost_cashcrop_sum_no_F_W_no_subsidy,transaction_cost_worker_sum_no_F_W_no_subsidy,c_M_worker_sum_no_F_W_no_subsidy,c_M_staple_sum_no_F_W_no_subsidy,c_M_cashcrop_sum_no_F_W_no_subsidy,
MPX_mean_log_no_F_W_no_subsidy, MPX_mean_staples_S_log_no_F_W_no_subsidy,MPX_mean_cashcrop_log_no_F_W_no_subsidy
, APland_mean_log_no_F_W_no_subsidy,APland_mean_cashcrop_log_no_F_W_no_subsidy, APland_mean_staples_S_log_no_F_W_no_subsidy,var_APland_no_F_W_no_subsidy,var_APland_cashcrop_no_F_W_no_subsidy,var_APland_staples_S_no_F_W_no_subsidy,
c_S_W_fine_no_F_W_no_subsidy,c_B_W_fine_no_F_W_no_subsidy,c_M_W_fine_no_F_W_no_subsidy,c_S_S_fine_no_F_W_no_subsidy,c_B_S_fine_no_F_W_no_subsidy,c_M_S_fine_no_F_W_no_subsidy,c_S_B_fine_no_F_W_no_subsidy,c_B_B_fine_no_F_W_no_subsidy,c_M_B_fine_no_F_W_no_subsidy) = details_model(prices_no_F_W_no_subsidy,no_F_W_no_subsidy_parameter,2,moments,0.0,foreign_supply_capital_subsidy_b);

#    No subsidy equilibrium + No FM_B
prices_no_FM_B_no_subsidy = [ 1.168581278103919,
0.21559107857631152];
no_FM_B_no_subsidy_parameter = copy(Baseline_parameter);
no_FM_B_no_subsidy_parameter.FM_B= 0.0;
no_FM_B_no_subsidy_parameter.τ_S=-0.0;
(residual_goods_no_FM_B_no_subsidy, stat_distr_no_FM_B_no_subsidy, cons_fine_local_no_FM_B_no_subsidy, a_prime_fine_local_no_FM_B_no_subsidy,future_occupation_fine_local_no_FM_B_no_subsidy,x_S_S_fine_no_FM_B_no_subsidy,x_SC_fine_no_FM_B_no_subsidy,x_BC_fine_no_FM_B_no_subsidy, coeff_no_FM_B_no_subsidy,
transaction_cost_loss_no_FM_B_no_subsidy,nominal_GDP_no_FM_B_no_subsidy,welfare_val_no_FM_B_no_subsidy,Import_value_no_FM_B_no_subsidy,Export_value_no_FM_B_no_subsidy,current_worker_pop_no_FM_B_no_subsidy,current_staple_pop_no_FM_B_no_subsidy,current_cashcrop_pop_no_FM_B_no_subsidy,
marketable_agr_surplus_share_no_FM_B_no_subsidy,exportshare_cashcrop_no_FM_B_no_subsidy,
fraction_model_no_FM_B_no_subsidy,program_spending_no_FM_B_no_subsidy,prod_value_improvement_no_FM_B_no_subsidy,share_selling_increase_no_FM_B_no_subsidy,exp_ratio_model_no_FM_B_no_subsidy,mig_rate_model_no_FM_B_no_subsidy,rural_pop_only_staples_model_no_FM_B_no_subsidy,rural_pop_only_cashcrop_model_no_FM_B_no_subsidy,
mean_land_share_to_staples_among_cc_model_no_FM_B_no_subsidy,urban_rural_inc_ratio_model_no_FM_B_no_subsidy,urban_rural_wealth_ratio_model_no_FM_B_no_subsidy,urban_rural_consumption_ratio_model_no_FM_B_no_subsidy,
p90_wealth_rural_no_FM_B_no_subsidy,p90_wealth_urban_no_FM_B_no_subsidy,p99_wealth_rural_no_FM_B_no_subsidy,p99_wealth_urban_no_FM_B_no_subsidy,p90_cons_tmp_no_FM_B_no_subsidy,p90_income_tmp_no_FM_B_no_subsidy,p99_cons_tmp_no_FM_B_no_subsidy,p99_income_tmp_no_FM_B_no_subsidy,
staple_productivity_no_FM_B_no_subsidy,cashcrop_productivity_no_FM_B_no_subsidy,manuf_productivity_no_FM_B_no_subsidy,relative_land_to_staples_no_FM_B_no_subsidy,relative_land_to_cashcrop_no_FM_B_no_subsidy,share_constrained_cashcrop_no_FM_B_no_subsidy,var_MPX_staples_S_no_FM_B_no_subsidy,var_MPX_cashcrop_B_no_FM_B_no_subsidy,var_MPX_cashcrop_S_no_FM_B_no_subsidy,
share_constrained_staple_no_FM_B_no_subsidy,APG_no_FM_B_no_subsidy,urban_rural_consumption_ratio_model_real_no_FM_B_no_subsidy,aggregate_consumption_no_FM_B_no_subsidy,
worker_pop_effective_no_FM_B_no_subsidy,prod_manuf_no_FM_B_no_subsidy,total_entry_cost_no_FM_B_no_subsidy,prod_staple_no_FM_B_no_subsidy,prod_cashcrop_no_FM_B_no_subsidy,input_staple_no_FM_B_no_subsidy,input_cashcrop_no_FM_B_no_subsidy,
total_maintenance_cost_no_FM_B_no_subsidy,current_account_residual_no_FM_B_no_subsidy,fraction_cashcrop_suboptimal_model_no_FM_B_no_subsidy,V_saved_no_FM_B_no_subsidy,avg_labor_prod_rural_no_FM_B_no_subsidy
,avg_labor_prod_urban_no_FM_B_no_subsidy,avg_agri_prod_rural_no_FM_B_no_subsidy,avg_agri_prod_urban_no_FM_B_no_subsidy,
var_MPX_cashcrop_no_FM_B_no_subsidy,var_MPX_no_FM_B_no_subsidy,TFP_no_FM_B_no_subsidy,YL_manuf_no_FM_B_no_subsidy ,
 YL_agr_no_FM_B_no_subsidy,coeff_var_labor_prod_rural_no_FM_B_no_subsidy,coeff_var_labor_prod_urban_no_FM_B_no_subsidy,
coeff_var_agri_prod_rural_no_FM_B_no_subsidy, coeff_var_agri_prod_urban_no_FM_B_no_subsidy,
p90_wealth_no_FM_B_no_subsidy,p99_wealth_no_FM_B_no_subsidy,p90_cons_no_FM_B_no_subsidy_rural,p99_cons_no_FM_B_no_subsidy_rural,p90_cons_no_FM_B_no_subsidy_urban,p99_cons_no_FM_B_no_subsidy_urban,p90_income_no_FM_B_no_subsidy_rural,
p99_income_no_FM_B_no_subsidy_rural,p90_income_no_FM_B_no_subsidy_urban,p99_income_no_FM_B_no_subsidy_urban,wealth_of_workers_no_FM_B_no_subsidy ,
wealth_of_staples_no_FM_B_no_subsidy ,wealth_of_cashcrop_no_FM_B_no_subsidy ,
c_B_worker_sum_no_FM_B_no_subsidy,c_B_staple_sum_no_FM_B_no_subsidy,c_B_cashcrop_sum_no_FM_B_no_subsidy,c_S_worker_sum_no_FM_B_no_subsidy,c_S_staple_sum_no_FM_B_no_subsidy ,c_S_cashcrop_sum_no_FM_B_no_subsidy,
transaction_cost_staple_sum_no_FM_B_no_subsidy,transaction_cost_cashcrop_sum_no_FM_B_no_subsidy,transaction_cost_worker_sum_no_FM_B_no_subsidy,c_M_worker_sum_no_FM_B_no_subsidy,c_M_staple_sum_no_FM_B_no_subsidy,c_M_cashcrop_sum_no_FM_B_no_subsidy,
MPX_mean_log_no_FM_B_no_subsidy, MPX_mean_staples_S_log_no_FM_B_no_subsidy,MPX_mean_cashcrop_log_no_FM_B_no_subsidy
, APland_mean_log_no_FM_B_no_subsidy,APland_mean_cashcrop_log_no_FM_B_no_subsidy, APland_mean_staples_S_log_no_FM_B_no_subsidy,var_APland_no_FM_B_no_subsidy,var_APland_cashcrop_no_FM_B_no_subsidy,var_APland_staples_S_no_FM_B_no_subsidy,
c_S_W_fine_no_FM_B_no_subsidy,c_B_W_fine_no_FM_B_no_subsidy,c_M_W_fine_no_FM_B_no_subsidy,c_S_S_fine_no_FM_B_no_subsidy,c_B_S_fine_no_FM_B_no_subsidy,c_M_S_fine_no_FM_B_no_subsidy,c_S_B_fine_no_FM_B_no_subsidy,c_B_B_fine_no_FM_B_no_subsidy,c_M_B_fine_no_FM_B_no_subsidy) = details_model(prices_no_FM_B_no_subsidy,no_FM_B_no_subsidy_parameter,2,moments,0.0,foreign_supply_capital_subsidy_b);

#    No subsidy equilibrium + high kappa
prices_no_κ_no_subsidy = [ 1.1696929055108973,
0.1890191391243493]#!
no_κ_parameter_no_subsidy = copy(Baseline_parameter);
no_κ_parameter_no_subsidy.κ= 10.0;
no_κ_parameter_no_subsidy.τ_S=-0.0;
(residual_goods_no_κ_no_subsidy, stat_distr_no_κ_no_subsidy, cons_fine_local_no_κ_no_subsidy, a_prime_fine_local_no_κ_no_subsidy,future_occupation_fine_local_no_κ_no_subsidy,x_S_S_fine_no_κ_no_subsidy,x_SC_fine_no_κ_no_subsidy,x_BC_fine_no_κ_no_subsidy, coeff_no_κ_no_subsidy,
transaction_cost_loss_no_κ_no_subsidy,nominal_GDP_no_κ_no_subsidy,welfare_val_no_κ_no_subsidy,Import_value_no_κ_no_subsidy,Export_value_no_κ_no_subsidy,current_worker_pop_no_κ_no_subsidy,current_staple_pop_no_κ_no_subsidy,current_cashcrop_pop_no_κ_no_subsidy,
marketable_agr_surplus_share_no_κ_no_subsidy,exportshare_cashcrop_no_κ_no_subsidy,
fraction_model_no_κ_no_subsidy,program_spending_no_κ_no_subsidy,prod_value_improvement_no_κ_no_subsidy,share_selling_increase_no_κ_no_subsidy,exp_ratio_model_no_κ_no_subsidy,mig_rate_model_no_κ_no_subsidy,rural_pop_only_staples_model_no_κ_no_subsidy,rural_pop_only_cashcrop_model_no_κ_no_subsidy,
mean_land_share_to_staples_among_cc_model_no_κ_no_subsidy,urban_rural_inc_ratio_model_no_κ_no_subsidy,urban_rural_wealth_ratio_model_no_κ_no_subsidy,urban_rural_consumption_ratio_model_no_κ_no_subsidy,
p90_wealth_rural_no_κ_no_subsidy,p90_wealth_urban_no_κ_no_subsidy,p99_wealth_rural_no_κ_no_subsidy,p99_wealth_urban_no_κ_no_subsidy,p90_cons_tmp_no_κ_no_subsidy,p90_income_tmp_no_κ_no_subsidy,p99_cons_tmp_no_κ_no_subsidy,p99_income_tmp_no_κ_no_subsidy,
staple_productivity_no_κ_no_subsidy,cashcrop_productivity_no_κ_no_subsidy,manuf_productivity_no_κ_no_subsidy,relative_land_to_staples_no_κ_no_subsidy,relative_land_to_cashcrop_no_κ_no_subsidy,share_constrained_cashcrop_no_κ_no_subsidy,var_MPX_staples_S_no_κ_no_subsidy,var_MPX_cashcrop_B_no_κ_no_subsidy,var_MPX_cashcrop_S_no_κ_no_subsidy,
share_constrained_staple_no_κ_no_subsidy,APG_no_κ_no_subsidy,urban_rural_consumption_ratio_model_real_no_κ_no_subsidy,aggregate_consumption_no_κ_no_subsidy,
worker_pop_effective_no_κ_no_subsidy,prod_manuf_no_κ_no_subsidy,total_entry_cost_no_κ_no_subsidy,prod_staple_no_κ_no_subsidy,prod_cashcrop_no_κ_no_subsidy,input_staple_no_κ_no_subsidy,input_cashcrop_no_κ_no_subsidy,
total_maintenance_cost_no_κ_no_subsidy,current_account_residual_no_κ_no_subsidy,fraction_cashcrop_suboptimal_model_no_κ_no_subsidy,V_saved_no_κ_no_subsidy,avg_labor_prod_rural_no_κ_no_subsidy
,avg_labor_prod_urban_no_κ_no_subsidy,avg_agri_prod_rural_no_κ_no_subsidy,avg_agri_prod_urban_no_κ_no_subsidy,
var_MPX_cashcrop_no_κ_no_subsidy,var_MPX_no_κ_no_subsidy,TFP_no_κ_no_subsidy,YL_manuf_no_κ_no_subsidy , 
YL_agr_no_κ_no_subsidy,coeff_var_labor_prod_rural_no_κ_no_subsidy,coeff_var_labor_prod_urban_no_κ_no_subsidy,
coeff_var_agri_prod_rural_no_κ_no_subsidy, coeff_var_agri_prod_urban_no_κ_no_subsidy,
p90_wealth_no_κ_no_subsidy,p99_wealth_no_κ_no_subsidy,p90_cons_no_κ_no_subsidy_rural,p99_cons_no_κ_no_subsidy_rural,p90_cons_no_κ_no_subsidy_urban,p99_cons_no_κ_no_subsidy_urban,p90_income_no_κ_no_subsidy_rural,
p99_income_no_κ_no_subsidy_rural,p90_income_no_κ_no_subsidy_urban,p99_income_no_κ_no_subsidy_urban,wealth_of_workers_no_κ_no_subsidy,
wealth_of_staples_no_κ_no_subsidy,wealth_of_cashcrop_no_κ_no_subsidy,
c_B_worker_sum_no_κ_no_subsidy,c_B_staple_sum_no_κ_no_subsidy,c_B_cashcrop_sum_no_κ_no_subsidy,c_S_worker_sum_no_κ_no_subsidy,c_S_staple_sum_no_κ_no_subsidy ,c_S_cashcrop_sum_no_κ_no_subsidy,
transaction_cost_staple_sum_no_κ_no_subsidy,transaction_cost_cashcrop_sum_no_κ_no_subsidy,transaction_cost_worker_sum_no_κ_no_subsidy,c_M_worker_sum_no_κ_no_subsidy,c_M_staple_sum_no_κ_no_subsidy,c_M_cashcrop_sum_no_κ_no_subsidy,
MPX_mean_log_no_κ_no_subsidy, MPX_mean_staples_S_log_no_κ_no_subsidy,MPX_mean_cashcrop_log_no_κ_no_subsidy
, APland_mean_log_no_κ_no_subsidy,APland_mean_cashcrop_log_no_κ_no_subsidy, APland_mean_staples_S_log_no_κ_no_subsidy,var_APland_no_κ_no_subsidy,var_APland_cashcrop_no_κ_no_subsidy,var_APland_staples_S_no_κ_no_subsidy,
c_S_W_fine_no_κ_no_subsidy,c_B_W_fine_no_κ_no_subsidy,c_M_W_fine_no_κ_no_subsidy,c_S_S_fine_no_κ_no_subsidy,c_B_S_fine_no_κ_no_subsidy,c_M_S_fine_no_κ_no_subsidy,c_S_B_fine_no_κ_no_subsidy,c_B_B_fine_no_κ_no_subsidy,c_M_B_fine_no_κ_no_subsidy) = details_model(prices_no_κ_no_subsidy,no_FM_B_no_subsidy_parameter,2,moments,0.0,foreign_supply_capital_subsidy_b);

## Subsidy equilibria
#    Subsidy equilibrium without balanced budget
prices_subsidy_nb = [ 1.50872539725031,
0.25456229194429497];

(residual_goods_subsidy_nb, stat_distr_subsidy_nb, cons_fine_local_subsidy_nb, a_prime_fine_local_subsidy_nb,future_occupation_fine_local_subsidy_nb,x_S_S_fine_subsidy_nb,x_SC_fine_subsidy_nb,x_BC_fine_subsidy_nb, coeff_subsidy_nb,
transaction_cost_loss_subsidy_nb,nominal_GDP_subsidy_nb,welfare_val_subsidy_nb,Import_value_subsidy_nb,Export_value_subsidy_nb,current_worker_pop_subsidy_nb,current_staple_pop_subsidy_nb,current_cashcrop_pop_subsidy_nb,
marketable_agr_surplus_share_subsidy_nb,exportshare_cashcrop_subsidy_nb,
fraction_model_subsidy_nb,program_spending_subsidy_nb,prod_value_improvement_subsidy_nb,share_selling_increase_subsidy_nb,exp_ratio_model_subsidy_nb,mig_rate_model_subsidy_nb,rural_pop_only_staples_model_subsidy_nb,rural_pop_only_cashcrop_model_subsidy_nb,
mean_land_share_to_staples_among_cc_model_subsidy_nb,urban_rural_inc_ratio_model_subsidy_nb,urban_rural_wealth_ratio_model_subsidy_nb,urban_rural_consumption_ratio_model_subsidy_nb,
p90_wealth_rural_subsidy_nb,p90_wealth_urban_subsidy_nb,p99_wealth_rural_subsidy_nb,p99_wealth_urban_subsidy_nb,p90_cons_tmp_subsidy_nb,p90_income_tmp_subsidy_nb,p99_cons_tmp_subsidy_nb,p99_income_tmp_subsidy_nb,
staple_productivity_subsidy_nb,cashcrop_productivity_subsidy_nb,manuf_productivity_subsidy_nb,relative_land_to_staples_subsidy_nb,relative_land_to_cashcrop_subsidy_nb,share_constrained_cashcrop_subsidy_nb,var_MPX_staples_S_subsidy_nb,var_MPX_cashcrop_B_subsidy_nb,var_MPX_cashcrop_S_subsidy_nb,
share_constrained_staple_subsidy_nb,APG_subsidy_nb,urban_rural_consumption_ratio_model_real_subsidy_nb,aggregate_consumption_subsidy_nb,
worker_pop_effective_subsidy_nb,prod_manuf_subsidy_nb,total_entry_cost_subsidy_nb,prod_staple_subsidy_nb,prod_cashcrop_subsidy_nb,input_staple_subsidy_nb,input_cashcrop_subsidy_nb,
total_maintenance_cost_subsidy_nb,current_account_residual_subsidy_nb,fraction_cashcrop_suboptimal_model_subsidy_nb,V_saved_subsidy_nb
,avg_labor_prod_rural_subsidy_nb,avg_labor_prod_urban_subsidy_nb,avg_agri_prod_rural_subsidy_nb,avg_agri_prod_urban_subsidy_nb,
var_MPX_cashcrop_subsidy_nb,var_MPX_subsidy_nb,TFP_subsidy_nb,YL_manuf_subsidy_nb , 
YL_agr_subsidy_nb,coeff_var_labor_prod_rural_subsidy_nb,coeff_var_labor_prod_urban_subsidy_nb,
coeff_var_agri_prod_rural_subsidy_nb, coeff_var_agri_prod_urban_subsidy_nb,
p90_wealth_subsidy_nb,p99_wealth_subsidy_nb,p90_cons_subsidy_nb_rural,p99_cons_subsidy_nb_rural,p90_cons_subsidy_nb_urban,p99_cons_subsidy_nb_urban,p90_income_subsidy_nb_rural,
p99_income_subsidy_nb_rural,p90_income_subsidy_nb_urban,p99_income_subsidy_nb_urban,wealth_of_workers_subsidy_nb,wealth_of_staples_subsidy_nb,
wealth_of_cashcrop_subsidy_nb,
c_B_worker_sum_subsidy_nb,c_B_staple_sum_subsidy_nb,c_B_cashcrop_sum_subsidy_nb,c_S_worker_sum_subsidy_nb,c_S_staple_sum_subsidy_nb ,c_S_cashcrop_sum_subsidy_nb,
transaction_cost_staple_sum_subsidy_nb,transaction_cost_cashcrop_sum_subsidy_nb,transaction_cost_worker_sum_subsidy_nb,c_M_worker_sum_subsidy_nb,c_M_staple_sum_subsidy_nb,c_M_cashcrop_sum_subsidy_nb
,MPX_mean_log_subsidy_nb, MPX_mean_staples_S_log_subsidy_nb,MPX_mean_cashcrop_log_subsidy_nb
, APland_mean_log_subsidy_nb,APland_mean_cashcrop_log_subsidy_nb, APland_mean_staples_S_log_subsidy_nb,var_APland_subsidy_nb,var_APland_cashcrop_subsidy_nb,var_APland_staples_S_subsidy_nb,
c_S_W_fine_subsidy_nb,c_B_W_fine_subsidy_nb,c_M_W_fine_subsidy_nb,c_S_S_fine_subsidy_nb,c_B_S_fine_subsidy_nb,c_M_S_fine_subsidy_nb,c_S_B_fine_subsidy_nb,c_B_B_fine_subsidy_nb,c_M_B_fine_subsidy_nb) = details_model(prices_subsidy_nb,Baseline_parameter,2,moments,0.0,foreign_supply_capital_subsidy_b);



#    Subsidy equilibrium with balanced budget
prices_subsidy_b = [ 1.518014329164464,
0.2726473607850526,
0.1886863641824446];

(residual_goods_subsidy_b, stat_distr_subsidy_b, cons_fine_local_subsidy_b, a_prime_fine_local_subsidy_b,future_occupation_fine_local_subsidy_b,x_S_S_fine_subsidy_b,x_SC_fine_subsidy_b,x_BC_fine_subsidy_b, coeff_subsidy_b,
transaction_cost_loss_subsidy_b,nominal_GDP_subsidy_b,welfare_val_subsidy_b,Import_value_subsidy_b,Export_value_subsidy_b,current_worker_pop_subsidy_b,current_staple_pop_subsidy_b,current_cashcrop_pop_subsidy_b,
marketable_agr_surplus_share_subsidy_b,exportshare_cashcrop_subsidy_b,
fraction_model_subsidy_b,program_spending_subsidy_b,prod_value_improvement_subsidy_b,share_selling_increase_subsidy_b,exp_ratio_model_subsidy_b,mig_rate_model_subsidy_b,rural_pop_only_staples_model_subsidy_b,rural_pop_only_cashcrop_model_subsidy_b,
mean_land_share_to_staples_among_cc_model_subsidy_b,urban_rural_inc_ratio_model_subsidy_b,urban_rural_wealth_ratio_model_subsidy_b,urban_rural_consumption_ratio_model_subsidy_b,
p90_wealth_rural_subsidy_b,p90_wealth_urban_subsidy_b,p99_wealth_rural_subsidy_b,p99_wealth_urban_subsidy_b,p90_cons_tmp_subsidy_b,p90_income_tmp_subsidy_b,p99_cons_tmp_subsidy_b,p99_income_tmp_subsidy_b,
staple_productivity_subsidy_b,cashcrop_productivity_subsidy_b,manuf_productivity_subsidy_b,relative_land_to_staples_subsidy_b,relative_land_to_cashcrop_subsidy_b,share_constrained_cashcrop_subsidy_b,var_MPX_staples_S_subsidy_b,var_MPX_cashcrop_B_subsidy_b,var_MPX_cashcrop_S_subsidy_b,
share_constrained_staple_subsidy_b,APG_subsidy_b,urban_rural_consumption_ratio_model_real_subsidy_b,aggregate_consumption_subsidy_b,
worker_pop_effective_subsidy_b,prod_manuf_subsidy_b,total_entry_cost_subsidy_b,prod_staple_subsidy_b,prod_cashcrop_subsidy_b,input_staple_subsidy_b,input_cashcrop_subsidy_b,
total_maintenance_cost_subsidy_b,current_account_residual_subsidy_b,fraction_cashcrop_suboptimal_model_subsidy_b,V_saved_subsidy_b
,avg_labor_prod_rural_subsidy_b,avg_labor_prod_urban_subsidy_b,avg_agri_prod_rural_subsidy_b,avg_agri_prod_urban_subsidy_b,
var_MPX_cashcrop_subsidy_b,var_MPX_subsidy_b,TFP_subsidy_b,YL_manuf_subsidy_b , 
YL_agr_subsidy_b,coeff_var_labor_prod_rural_subsidy_b,coeff_var_labor_prod_urban_subsidy_b,
coeff_var_agri_prod_rural_subsidy_b, coeff_var_agri_prod_urban_subsidy_b,
p90_wealth_subsidy_b,p99_wealth_subsidy_b,p90_cons_subsidy_b_rural,p99_cons_subsidy_b_rural,p90_cons_subsidy_b_urban,p99_cons_subsidy_b_urban,p90_income_subsidy_b_rural,
p99_income_subsidy_b_rural,p90_income_subsidy_b_urban,p99_income_tmp_urban,wealth_of_workers_subsidy_b,wealth_of_staples_subsidy_b,wealth_of_cashcrop_subsidy_b,
c_B_worker_sum_subsidy_b,c_B_staple_sum_subsidy_b,c_B_cashcrop_sum_subsidy_b,c_S_worker_sum_subsidy_b,c_S_staple_sum_subsidy_b ,c_S_cashcrop_sum_subsidy_b,
transaction_cost_staple_sum_subsidy_b,transaction_cost_cashcrop_sum_subsidy_b,transaction_cost_worker_sum_subsidy_b,c_M_worker_sum_subsidy_b,c_M_staple_sum_subsidy_b,c_M_cashcrop_sum_subsidy_b
,MPX_mean_log_subsidy_b, MPX_mean_staples_S_log_subsidy_b,MPX_mean_cashcrop_log_subsidy_b
, APland_mean_log_subsidy_b,APland_mean_cashcrop_log_subsidy_b, APland_mean_staples_S_log_subsidy_b,var_APland_subsidy_b,var_APland_cashcrop_subsidy_b,var_APland_staples_S_subsidy_b,
c_S_W_fine_subsidy_b,c_B_W_fine_subsidy_b,c_M_W_fine_subsidy_b,c_S_S_fine_subsidy_b,c_B_S_fine_subsidy_b,c_M_S_fine_subsidy_b,c_S_B_fine_subsidy_b,c_B_B_fine_subsidy_b,c_M_B_fine_subsidy_b)   = details_model(prices_subsidy_b,Baseline_parameter,2,moments,1.0,foreign_supply_capital_subsidy_b);

#    Subsidy partial equilibrium without any price adjustment
prices_subsidy_partial = [  1.188283177632008,
0.18349666252335484,
0.0];

(residual_goods_subsidy_partial, stat_distr_subsidy_partial, cons_fine_local_subsidy_partial, a_prime_fine_local_subsidy_partial,future_occupation_fine_local_subsidy_partial,x_S_S_fine_subsidy_partial,x_SC_fine_subsidy_partial,x_BC_fine_subsidy_partial, coeff_subsidy_partial,
transaction_cost_loss_subsidy_partial,nominal_GDP_subsidy_partial,welfare_val_subsidy_partial,Import_value_subsidy_partial,Export_value_subsidy_partial,current_worker_pop_subsidy_partial,current_staple_pop_subsidy_partial,current_cashcrop_pop_subsidy_partial,
marketable_agr_surplus_share_subsidy_partial,exportshare_cashcrop_subsidy_partial,
fraction_model_subsidy_partial,program_spending_subsidy_partial,prod_value_improvement_subsidy_partial,share_selling_increase_subsidy_partial,exp_ratio_model_subsidy_partial,mig_rate_model_subsidy_partial,rural_pop_only_staples_model_subsidy_partial,rural_pop_only_cashcrop_model_subsidy_partial,
mean_land_share_to_staples_among_cc_model_subsidy_partial,urban_rural_inc_ratio_model_subsidy_partial,urban_rural_wealth_ratio_model_subsidy_partial,urban_rural_consumption_ratio_model_subsidy_partial,
p90_wealth_rural_subsidy_partial,p90_wealth_urban_subsidy_partial,p99_wealth_rural_subsidy_partial,p99_wealth_urban_subsidy_partial,p90_cons_tmp_subsidy_partial,p90_income_tmp_subsidy_partial,p99_cons_tmp_subsidy_partial,p99_income_tmp_subsidy_partial,
staple_productivity_subsidy_partial,cashcrop_productivity_subsidy_partial,manuf_productivity_subsidy_partial,relative_land_to_staples_subsidy_partial,relative_land_to_cashcrop_subsidy_partial,share_constrained_cashcrop_subsidy_partial,var_MPX_staples_S_subsidy_partial,var_MPX_cashcrop_B_subsidy_partial,var_MPX_cashcrop_S_subsidy_partial,
share_constrained_staple_subsidy_partial,APG_subsidy_partial,urban_rural_consumption_ratio_model_real_subsidy_partial,aggregate_consumption_subsidy_partial,
worker_pop_effective_subsidy_partial,prod_manuf_subsidy_partial,total_entry_cost_subsidy_partial,prod_staple_subsidy_partial,prod_cashcrop_subsidy_partial,input_staple_subsidy_partial,input_cashcrop_subsidy_partial,
total_maintenance_cost_subsidy_partial,current_account_residual_subsidy_partial,fraction_cashcrop_suboptimal_model_subsidy_partial,V_saved_subsidy_partial
,avg_labor_prod_rural_subsidy_partial,avg_labor_prod_urban_subsidy_partial,avg_agri_prod_rural_subsidy_partial,avg_agri_prod_urban_subsidy_partial,
var_MPX_cashcrop_subsidy_partial,var_MPX_subsidy_partial,TFP_subsidy_partial,YL_manuf_subsidy_partial , 
YL_agr_subsidy_partial,coeff_var_labor_prod_rural_subsidy_partial,coeff_var_labor_prod_urban_subsidy_partial,
coeff_var_agri_prod_rural_subsidy_partial, coeff_var_agri_prod_urban_subsidy_partial,
p90_wealth_subsidy_partial,p99_wealth_subsidy_partial,p90_cons_subsidy_partial_rural,p99_cons_subsidy_partial_rural,p90_cons_subsidy_partial_urban,p99_cons_subsidy_partial_urban,p90_income_subsidy_partial_rural,
p99_income_subsidy_partial_rural,p90_income_subsidy_partial_urban,p99_income_tmp_urban,wealth_of_workers_subsidy_partial,wealth_of_staples_subsidy_partial,wealth_of_cashcrop_subsidy_partial,
c_B_worker_sum_subsidy_partial,c_B_staple_sum_subsidy_partial,c_B_cashcrop_sum_subsidy_partial,c_S_worker_sum_subsidy_partial,c_S_staple_sum_subsidy_partial ,c_S_cashcrop_sum_subsidy_partial,
transaction_cost_staple_sum_subsidy_partial,transaction_cost_cashcrop_sum_subsidy_partial,transaction_cost_worker_sum_subsidy_partial,c_M_worker_sum_subsidy_partial,c_M_staple_sum_subsidy_partial,c_M_cashcrop_sum_subsidy_partial
,MPX_mean_log_subsidy_partial, MPX_mean_staples_S_log_subsidy_partial,MPX_mean_cashcrop_log_subsidy_partial
, APland_mean_log_subsidy_partial,APland_mean_cashcrop_log_subsidy_partial, APland_mean_staples_S_log_subsidy_partial,var_APland_subsidy_partial,var_APland_cashcrop_subsidy_partial,var_APland_staples_S_subsidy_partial,
c_S_W_fine_subsidy_partial,c_B_W_fine_subsidy_partial,c_M_W_fine_subsidy_partial,c_S_S_fine_subsidy_partial,c_B_S_fine_subsidy_partial,c_M_S_fine_subsidy_partial,c_S_B_fine_subsidy_partial,c_B_B_fine_subsidy_partial,c_M_B_fine_subsidy_partial)    = details_model(prices_subsidy_partial,Baseline_parameter,2,moments,1.0,foreign_supply_capital_subsidy_b);


#    Subsidy equilibrium with balanced budget + No QS
prices_no_QS_subsidy_b =  [ 1.5073211207397117,
0.206306989703047,
0.17586675729012607]
no_QS_parameter = copy(Baseline_parameter);
no_QS_parameter.Q_S=0.0;
(residual_goods_no_QS_subsidy_b, stat_distr_no_QS_subsidy_b, cons_fine_local_no_QS_subsidy_b, a_prime_fine_local_no_QS_subsidy_b,future_occupation_fine_local_no_QS_subsidy_b,x_S_S_fine_no_QS_subsidy_b,x_SC_fine_no_QS_subsidy_b,x_BC_fine_no_QS_subsidy_b, coeff_no_QS_subsidy_b,
transaction_cost_loss_no_QS_subsidy_b,nominal_GDP_no_QS_subsidy_b,welfare_val_no_QS_subsidy_b,Import_value_no_QS_subsidy_b,Export_value_no_QS_subsidy_b,current_worker_pop_no_QS_subsidy_b,current_staple_pop_no_QS_subsidy_b,current_cashcrop_pop_no_QS_subsidy_b,
marketable_agr_surplus_share_no_QS_subsidy_b,exportshare_cashcrop_no_QS_subsidy_b,
fraction_model_no_QS_subsidy_b,program_spending_no_QS_subsidy_b,prod_value_improvement_no_QS_subsidy_b,share_selling_increase_no_QS_subsidy_b,exp_ratio_model_no_QS_subsidy_b,mig_rate_model_no_QS_subsidy_b,rural_pop_only_staples_model_no_QS_subsidy_b,rural_pop_only_cashcrop_model_no_QS_subsidy_b,
mean_land_share_to_staples_among_cc_model_no_QS_subsidy_b,urban_rural_inc_ratio_model_no_QS_subsidy_b,urban_rural_wealth_ratio_model_no_QS_subsidy_b,urban_rural_consumption_ratio_model_no_QS_subsidy_b,
p90_wealth_rural_no_QS_subsidy_b,p90_wealth_urban_no_QS_subsidy_b,p99_wealth_rural_no_QS_subsidy_b,p99_wealth_urban_no_QS_subsidy_b,p90_cons_tmp_no_QS_subsidy_b,p90_income_tmp_no_QS_subsidy_b,p99_cons_tmp_no_QS_subsidy_b,p99_income_tmp_no_QS_subsidy_b,
staple_productivity_no_QS_subsidy_b,cashcrop_productivity_no_QS_subsidy_b,manuf_productivity_no_QS_subsidy_b,relative_land_to_staples_no_QS_subsidy_b,relative_land_to_cashcrop_no_QS_subsidy_b,share_constrained_cashcrop_no_QS_subsidy_b,var_MPX_staples_S_no_QS_subsidy_b,var_MPX_cashcrop_B_no_QS_subsidy_b,var_MPX_cashcrop_S_no_QS_subsidy_b,
share_constrained_staple_no_QS_subsidy_b,APG_no_QS_subsidy_b,urban_rural_consumption_ratio_model_real_no_QS_subsidy_b,aggregate_consumption_no_QS_subsidy_b,
worker_pop_effective_no_QS_subsidy_b,prod_manuf_no_QS_subsidy_b,total_entry_cost_no_QS_subsidy_b,prod_staple_no_QS_subsidy_b,prod_cashcrop_no_QS_subsidy_b,input_staple_no_QS_subsidy_b,input_cashcrop_no_QS_subsidy_b,
total_maintenance_cost_no_QS_subsidy_b,current_account_residual_no_QS_subsidy_b,fraction_cashcrop_suboptimal_model_no_QS_subsidy_b,V_saved_no_QS_subsidy_b
,avg_labor_prod_rural_no_QS_subsidy_b,avg_labor_prod_urban_no_QS_subsidy_b,avg_agri_prod_rural_no_QS_subsidy_b,avg_agri_prod_urban_no_QS_subsidy_b,
var_MPX_cashcrop_no_QS_subsidy_b ,var_MPX_no_QS_subsidy_b ,TFP_no_QS_subsidy_b ,YL_manuf_no_QS_subsidy_b  , 
YL_agr_no_QS_subsidy_b ,coeff_var_labor_prod_rural_no_QS_subsidy_b ,coeff_var_labor_prod_urban_no_QS_subsidy_b ,
coeff_var_agri_prod_rural_no_QS_subsidy_b , coeff_var_agri_prod_urban_no_QS_subsidy_b ,
p90_wealth_no_QS_subsidy_b,p99_wealth_no_QS_subsidy_b,p90_cons_no_QS_subsidy_b_rural,p99_cons_no_QS_subsidy_b_rural,p90_cons_no_QS_subsidy_b_urban,p99_cons_no_QS_subsidy_b_urban,p90_income_no_QS_subsidy_b_rural,
p99_income_no_QS_subsidy_b_rural,p90_income_no_QS_subsidy_b_urban,p99_income_no_QS_subsidy_b_urban,wealth_of_workers_no_QS_subsidy_b,
wealth_of_staples_no_QS_subsidy_b,wealth_of_cashcrop_no_QS_subsidy_b,
c_B_worker_sum_no_QS_subsidy_b,c_B_staple_sum_no_QS_subsidy_b,c_B_cashcrop_sum_no_QS_subsidy_b,c_S_worker_sum_no_QS_subsidy_b,c_S_staple_sum_no_QS_subsidy_b ,c_S_cashcrop_sum_no_QS_subsidy_b,
transaction_cost_staple_sum_no_QS_subsidy_b,transaction_cost_cashcrop_sum_no_QS_subsidy_b,transaction_cost_worker_sum_no_QS_subsidy_b,c_M_worker_sum_no_QS_subsidy_b,c_M_staple_sum_no_QS_subsidy_b,c_M_cashcrop_sum_no_QS_subsidy_b
,MPX_mean_log_no_QS_subsidy_b, MPX_mean_staples_S_log_no_QS_subsidy_b,MPX_mean_cashcrop_log_no_QS_subsidy_b
, APland_mean_log_no_QS_subsidy_b,APland_mean_cashcrop_log_no_QS_subsidy_b, APland_mean_staples_S_log_no_QS_subsidy_b,var_APland_no_QS_subsidy_b,var_APland_cashcrop_no_QS_subsidy_b,var_APland_staples_S_no_QS_subsidy_b,
c_S_W_fine_no_QS_subsidy_b,c_B_W_fine_no_QS_subsidy_b,c_M_W_fine_no_QS_subsidy_b,c_S_S_fine_no_QS_subsidy_b,c_B_S_fine_no_QS_subsidy_b,c_M_S_fine_no_QS_subsidy_b,c_S_B_fine_no_QS_subsidy_b,c_B_B_fine_no_QS_subsidy_b,c_M_B_fine_no_QS_subsidy_b) = details_model(prices_no_QS_subsidy_b,no_QS_parameter,2,moments,1.0,foreign_supply_capital_subsidy_b);

#    Subsidy equilibrium with balanced budget + No cbar
prices_no_cbar_subsidy_b = [  1.5435433787380388,
0.259856531535514,
0.19293976562040993]
no_cbar_parameter = copy(Baseline_parameter);
no_cbar_parameter.c̄_S = 0.0
(residual_goods_no_cbar_subsidy_b, stat_distr_no_cbar_subsidy_b, cons_fine_local_no_cbar_subsidy_b, a_prime_fine_local_no_cbar_subsidy_b,future_occupation_fine_local_no_cbar_subsidy_b,x_S_S_fine_no_cbar_subsidy_b,x_SC_fine_no_cbar_subsidy_b,x_BC_fine_no_cbar_subsidy_b, coeff_no_cbar_subsidy_b,
transaction_cost_loss_no_cbar_subsidy_b,nominal_GDP_no_cbar_subsidy_b,welfare_val_no_cbar_subsidy_b,Import_value_no_cbar_subsidy_b,Export_value_no_cbar_subsidy_b,current_worker_pop_no_cbar_subsidy_b,current_staple_pop_no_cbar_subsidy_b,current_cashcrop_pop_no_cbar_subsidy_b,
marketable_agr_surplus_share_no_cbar_subsidy_b,exportshare_cashcrop_no_cbar_subsidy_b,
fraction_model_no_cbar_subsidy_b,program_spending_no_cbar_subsidy_b,prod_value_improvement_no_cbar_subsidy_b,share_selling_increase_no_cbar_subsidy_b,exp_ratio_model_no_cbar_subsidy_b,mig_rate_model_no_cbar_subsidy_b,rural_pop_only_staples_model_no_cbar_subsidy_b,rural_pop_only_cashcrop_model_no_cbar_subsidy_b,
mean_land_share_to_staples_among_cc_model_no_cbar_subsidy_b,urban_rural_inc_ratio_model_no_cbar_subsidy_b,urban_rural_wealth_ratio_model_no_cbar_subsidy_b,urban_rural_consumption_ratio_model_no_cbar_subsidy_b,
p90_wealth_rural_no_cbar_subsidy_b,p90_wealth_urban_no_cbar_subsidy_b,p99_wealth_rural_no_cbar_subsidy_b,p99_wealth_urban_no_cbar_subsidy_b,p90_cons_tmp_no_cbar_subsidy_b,p90_income_tmp_no_cbar_subsidy_b,p99_cons_tmp_no_cbar_subsidy_b,p99_income_tmp_no_cbar_subsidy_b,
staple_productivity_no_cbar_subsidy_b,cashcrop_productivity_no_cbar_subsidy_b,manuf_productivity_no_cbar_subsidy_b,relative_land_to_staples_no_cbar_subsidy_b,relative_land_to_cashcrop_no_cbar_subsidy_b,share_constrained_cashcrop_no_cbar_subsidy_b,var_MPX_staples_S_no_cbar_subsidy_b,var_MPX_cashcrop_B_no_cbar_subsidy_b,var_MPX_cashcrop_S_no_cbar_subsidy_b,
share_constrained_staple_no_cbar_subsidy_b,APG_no_cbar_subsidy_b,urban_rural_consumption_ratio_model_real_no_cbar_subsidy_b,aggregate_consumption_no_cbar_subsidy_b,
worker_pop_effective_no_cbar_subsidy_b,prod_manuf_no_cbar_subsidy_b,total_entry_cost_no_cbar_subsidy_b,prod_staple_no_cbar_subsidy_b,prod_cashcrop_no_cbar_subsidy_b,input_staple_no_cbar_subsidy_b,input_cashcrop_no_cbar_subsidy_b,
total_maintenance_cost_no_cbar_subsidy_b,current_account_residual_no_cbar_subsidy_b,fraction_cashcrop_suboptimal_model_no_cbar_subsidy_b,V_saved_no_cbar_subsidy_b
,avg_labor_prod_rural_no_cbar_subsidy_b,avg_labor_prod_urban_no_cbar_subsidy_b,avg_agri_prod_rural_no_cbar_subsidy_b,avg_agri_prod_urban_no_cbar_subsidy_b,
var_MPX_cashcrop_no_cbar_subsidy_b ,var_MPX_no_cbar_subsidy_b ,TFP_no_cbar_subsidy_b ,YL_manuf_no_cbar_subsidy_b  , 
YL_agr_no_cbar_subsidy_b ,coeff_var_labor_prod_rural_no_cbar_subsidy_b ,coeff_var_labor_prod_urban_no_cbar_subsidy_b ,
coeff_var_agri_prod_rural_no_cbar_subsidy_b , coeff_var_agri_prod_urban_no_cbar_subsidy_b ,
p90_wealth_no_cbar_subsidy_b,p99_wealth_no_cbar_subsidy_b,p90_cons_no_cbar_subsidy_b_rural,p99_cons_no_cbar_subsidy_b_rural,p90_cons_no_cbar_subsidy_b_urban,p99_cons_no_cbar_subsidy_b_urban,p90_income_no_cbar_subsidy_b_rural,
p99_income_no_cbar_subsidy_b_rural,p90_income_no_cbar_subsidy_b_urban,p99_income_no_cbar_subsidy_b_urban,wealth_of_workers_no_cbar_subsidy_b,
wealth_of_staples_no_cbar_subsidy_b,wealth_of_cashcrop_no_cbar_subsidy_b,
c_B_worker_sum_no_cbar_subsidy_b,c_B_staple_sum_no_cbar_subsidy_b,c_B_cashcrop_sum_no_cbar_subsidy_b,c_S_worker_sum_no_cbar_subsidy_b,c_S_staple_sum_no_cbar_subsidy_b ,c_S_cashcrop_sum_no_cbar_subsidy_b,
transaction_cost_staple_sum_no_cbar_subsidy_b,transaction_cost_cashcrop_sum_no_cbar_subsidy_b,transaction_cost_worker_sum_no_cbar_subsidy_b,c_M_worker_sum_no_cbar_subsidy_b,c_M_staple_sum_no_cbar_subsidy_b,c_M_cashcrop_sum_no_cbar_subsidy_b
,MPX_mean_log_no_cbar_subsidy_b, MPX_mean_staples_S_log_no_cbar_subsidy_b,MPX_mean_cashcrop_log_no_cbar_subsidy_b
, APland_mean_log_no_cbar_subsidy_b,APland_mean_cashcrop_log_no_cbar_subsidy_b, APland_mean_staples_S_log_no_cbar_subsidy_b,var_APland_no_cbar_subsidy_b,var_APland_cashcrop_no_cbar_subsidy_b,var_APland_staples_S_no_cbar_subsidy_b,
c_S_W_fine_no_cbar_subsidy_b,c_B_W_fine_no_cbar_subsidy_b,c_M_W_fine_no_cbar_subsidy_b,c_S_S_fine_no_cbar_subsidy_b,c_B_S_fine_no_cbar_subsidy_b,c_M_S_fine_no_cbar_subsidy_b,c_S_B_fine_no_cbar_subsidy_b,c_B_B_fine_no_cbar_subsidy_b,c_M_B_fine_no_cbar_subsidy_b) = details_model(prices_no_cbar_subsidy_b,no_cbar_parameter,2,moments,1.0,foreign_supply_capital_subsidy_b);

#    Subsidy equilibrium with balanced budget + No cbar QS
prices_no_cbarQS_subsidy_b = [ 1.516811586169806,
0.20967990557054922,
0.16861791381781926]
no_cbarQS_parameter = copy(Baseline_parameter);
no_cbarQS_parameter.Q_S=0.0;
no_cbarQS_parameter.c̄_S = 0.0
(residual_goods_no_cbarQS_subsidy_b, stat_distr_no_cbarQS_subsidy_b, cons_fine_local_no_cbarQS_subsidy_b, a_prime_fine_local_no_cbarQS_subsidy_b,future_occupation_fine_local_no_cbarQS_subsidy_b,x_S_S_fine_no_cbarQS_subsidy_b,x_SC_fine_no_cbarQS_subsidy_b,x_BC_fine_no_cbarQS_subsidy_b, coeff_no_cbarQS_subsidy_b,
transaction_cost_loss_no_cbarQS_subsidy_b,nominal_GDP_no_cbarQS_subsidy_b,welfare_val_no_cbarQS_subsidy_b,Import_value_no_cbarQS_subsidy_b,Export_value_no_cbarQS_subsidy_b,current_worker_pop_no_cbarQS_subsidy_b,current_staple_pop_no_cbarQS_subsidy_b,current_cashcrop_pop_no_cbarQS_subsidy_b,
marketable_agr_surplus_share_no_cbarQS_subsidy_b,exportshare_cashcrop_no_cbarQS_subsidy_b,
fraction_model_no_cbarQS_subsidy_b,program_spending_no_cbarQS_subsidy_b,prod_value_improvement_no_cbarQS_subsidy_b,share_selling_increase_no_cbarQS_subsidy_b,exp_ratio_model_no_cbarQS_subsidy_b,mig_rate_model_no_cbarQS_subsidy_b,rural_pop_only_staples_model_no_cbarQS_subsidy_b,rural_pop_only_cashcrop_model_no_cbarQS_subsidy_b,
mean_land_share_to_staples_among_cc_model_no_cbarQS_subsidy_b,urban_rural_inc_ratio_model_no_cbarQS_subsidy_b,urban_rural_wealth_ratio_model_no_cbarQS_subsidy_b,urban_rural_consumption_ratio_model_no_cbarQS_subsidy_b,
p90_wealth_rural_no_cbarQS_subsidy_b,p90_wealth_urban_no_cbarQS_subsidy_b,p99_wealth_rural_no_cbarQS_subsidy_b,p99_wealth_urban_no_cbarQS_subsidy_b,p90_cons_tmp_no_cbarQS_subsidy_b,p90_income_tmp_no_cbarQS_subsidy_b,p99_cons_tmp_no_cbarQS_subsidy_b,p99_income_tmp_no_cbarQS_subsidy_b,
staple_productivity_no_cbarQS_subsidy_b,cashcrop_productivity_no_cbarQS_subsidy_b,manuf_productivity_no_cbarQS_subsidy_b,relative_land_to_staples_no_cbarQS_subsidy_b,relative_land_to_cashcrop_no_cbarQS_subsidy_b,share_constrained_cashcrop_no_cbarQS_subsidy_b,var_MPX_staples_S_no_cbarQS_subsidy_b,var_MPX_cashcrop_B_no_cbarQS_subsidy_b,var_MPX_cashcrop_S_no_cbarQS_subsidy_b,
share_constrained_staple_no_cbarQS_subsidy_b,APG_no_cbarQS_subsidy_b,urban_rural_consumption_ratio_model_real_no_cbarQS_subsidy_b,aggregate_consumption_no_cbarQS_subsidy_b,
worker_pop_effective_no_cbarQS_subsidy_b,prod_manuf_no_cbarQS_subsidy_b,total_entry_cost_no_cbarQS_subsidy_b,prod_staple_no_cbarQS_subsidy_b,prod_cashcrop_no_cbarQS_subsidy_b,input_staple_no_cbarQS_subsidy_b,input_cashcrop_no_cbarQS_subsidy_b,
total_maintenance_cost_no_cbarQS_subsidy_b,current_account_residual_no_cbarQS_subsidy_b,fraction_cashcrop_suboptimal_model_no_cbarQS_subsidy_b,V_saved_no_cbarQS_subsidy_b
,avg_labor_prod_rural_no_cbar_subsidy_b,avg_labor_prod_urban_no_cbar_subsidy_b,avg_agri_prod_rural_no_cbar_subsidy_b,avg_agri_prod_urban_no_cbar_subsidy_b,
var_MPX_cashcrop_no_cbarQS_subsidy_b ,var_MPX_no_cbarQS_subsidy_b ,TFP_no_cbarQS_subsidy_b ,YL_manuf_no_cbarQS_subsidy_b  , 
YL_agr_no_cbarQS_subsidy_b ,coeff_var_labor_prod_rural_no_cbarQS_subsidy_b ,coeff_var_labor_prod_urban_no_cbarQS_subsidy_b ,
coeff_var_agri_prod_rural_no_cbarQS_subsidy_b , coeff_var_agri_prod_urban_no_cbarQS_subsidy_b ,
p90_wealth_no_cbarQS_subsidy_b,p99_wealth_no_cbarQS_subsidy_b,p90_cons_no_cbarQS_subsidy_b_rural,p99_cons_no_cbarQS_subsidy_b_rural,p90_cons_no_cbarQS_subsidy_b_urban,p99_cons_no_cbarQS_subsidy_b_urban,p90_income_no_cbarQS_subsidy_b_rural,
p99_income_no_cbarQS_subsidy_b_rural,p90_income_no_cbarQS_subsidy_b_urban,p99_income_tmp_urban,
wealth_of_workers_no_cbarQS_subsidy_b,wealth_of_staples_no_cbarQS_subsidy_b,wealth_of_cashcrop_no_cbarQS_subsidy_b,
c_B_worker_sum_no_cbarQS_subsidy_b,c_B_staple_sum_no_cbarQS_subsidy_b,c_B_cashcrop_sum_no_cbarQS_subsidy_b,c_S_worker_sum_no_cbarQS_subsidy_b,c_S_staple_sum_no_cbarQS_subsidy_b ,c_S_cashcrop_sum_no_cbarQS_subsidy_b,
transaction_cost_staple_sum_no_cbarQS_subsidy_b,transaction_cost_cashcrop_sum_no_cbarQS_subsidy_b,transaction_cost_worker_sum_no_cbarQS_subsidy_b,c_M_worker_sum_no_cbarQS_subsidy_b,c_M_staple_sum_no_cbarQS_subsidy_b,c_M_cashcrop_sum_no_cbarQS_subsidy_b
,MPX_mean_log_no_cbarQS_subsidy_b, MPX_mean_staples_S_log_no_cbarQS_subsidy_b,MPX_mean_cashcrop_log_no_cbarQS_subsidy_b
, APland_mean_log_no_cbarQS_subsidy_b,APland_mean_cashcrop_log_no_cbarQS_subsidy_b, APland_mean_staples_S_log_no_cbarQS_subsidy_b,var_APland_no_cbarQS_subsidy_b,var_APland_cashcrop_no_cbarQS_subsidy_b,var_APland_staples_S_no_cbarQS_subsidy_b,
c_S_W_fine_no_cbarQS_subsidy_b,c_B_W_fine_no_cbarQS_subsidy_b,c_M_W_fine_no_cbarQS_subsidy_b,c_S_S_fine_no_cbarQS_subsidy_b,c_B_S_fine_no_cbarQS_subsidy_b,c_M_S_fine_no_cbarQS_subsidy_b,c_S_B_fine_no_cbarQS_subsidy_b,c_B_B_fine_no_cbarQS_subsidy_b,c_M_B_fine_no_cbarQS_subsidy_b) = details_model(prices_no_cbarQS_subsidy_b,no_cbarQS_parameter,2,moments,1.0,foreign_supply_capital_subsidy_b);


#    Subsidy equilibrium with balanced budget + No F_W
prices_no_F_W_subsidy_b = [ 1.4796471392365003,
0.14138775404436385,
0.1605285734494441]
no_F_W_parameter = copy(Baseline_parameter);
no_F_W_parameter.F_W= 0.0;
(residual_goods_no_F_W_subsidy_b, stat_distr_no_F_W_subsidy_b, cons_fine_local_no_F_W_subsidy_b, a_prime_fine_local_no_F_W_subsidy_b,future_occupation_fine_local_no_F_W_subsidy_b,x_S_S_fine_no_F_W_subsidy_b,x_SC_fine_no_F_W_subsidy_b,x_BC_fine_no_F_W_subsidy_b, coeff_no_F_W_subsidy_b,
transaction_cost_loss_no_F_W_subsidy_b,nominal_GDP_no_F_W_subsidy_b,welfare_val_no_F_W_subsidy_b,Import_value_no_F_W_subsidy_b,Export_value_no_F_W_subsidy_b,current_worker_pop_no_F_W_subsidy_b,current_staple_pop_no_F_W_subsidy_b,current_cashcrop_pop_no_F_W_subsidy_b,
marketable_agr_surplus_share_no_F_W_subsidy_b,exportshare_cashcrop_no_F_W_subsidy_b,
fraction_model_no_F_W_subsidy_b,program_spending_no_F_W_subsidy_b,prod_value_improvement_no_F_W_subsidy_b,share_selling_increase_no_F_W_subsidy_b,exp_ratio_model_no_F_W_subsidy_b,mig_rate_model_no_F_W_subsidy_b,rural_pop_only_staples_model_no_F_W_subsidy_b,rural_pop_only_cashcrop_model_no_F_W_subsidy_b,
mean_land_share_to_staples_among_cc_model_no_F_W_subsidy_b,urban_rural_inc_ratio_model_no_F_W_subsidy_b,urban_rural_wealth_ratio_model_no_F_W_subsidy_b,urban_rural_consumption_ratio_model_no_F_W_subsidy_b,
p90_wealth_rural_no_F_W_subsidy_b,p90_wealth_urban_no_F_W_subsidy_b,p99_wealth_rural_no_F_W_subsidy_b,p99_wealth_urban_no_F_W_subsidy_b,p90_cons_tmp_no_F_W_subsidy_b,p90_income_tmp_no_F_W_subsidy_b,p99_cons_tmp_no_F_W_subsidy_b,p99_income_tmp_no_F_W_subsidy_b,
staple_productivity_no_F_W_subsidy_b,cashcrop_productivity_no_F_W_subsidy_b,manuf_productivity_no_F_W_subsidy_b,relative_land_to_staples_no_F_W_subsidy_b,relative_land_to_cashcrop_no_F_W_subsidy_b,share_constrained_cashcrop_no_F_W_subsidy_b,var_MPX_staples_S_no_F_W_subsidy_b,var_MPX_cashcrop_B_no_F_W_subsidy_b,var_MPX_cashcrop_S_no_F_W_subsidy_b,
share_constrained_staple_no_F_W_subsidy_b,APG_no_F_W_subsidy_b,urban_rural_consumption_ratio_model_real_no_F_W_subsidy_b,aggregate_consumption_no_F_W_subsidy_b,
worker_pop_effective_no_F_W_subsidy_b,prod_manuf_no_F_W_subsidy_b,total_entry_cost_no_F_W_subsidy_b,prod_staple_no_F_W_subsidy_b,prod_cashcrop_no_F_W_subsidy_b,input_staple_no_F_W_subsidy_b,input_cashcrop_no_F_W_subsidy_b,
total_maintenance_cost_no_F_W_subsidy_b,current_account_residual_no_F_W_subsidy_b,fraction_cashcrop_suboptimal_model_no_F_W_subsidy_b,V_saved_no_F_W_subsidy_b
,avg_labor_prod_rural_no_F_W_subsidy_b,avg_labor_prod_urban_no_F_W_subsidy_b,avg_agri_prod_rural_no_F_W_subsidy_b,avg_agri_prod_urban_no_F_W_subsidy_b,
var_MPX_cashcrop_no_F_W_subsidy_b ,var_MPX_no_F_W_subsidy_b ,TFP_no_F_W_subsidy_b ,YL_manuf_no_F_W_subsidy_b  , 
YL_agr_no_F_W_subsidy_b ,coeff_var_labor_prod_rural_no_F_W_subsidy_b ,coeff_var_labor_prod_urban_no_F_W_subsidy_b ,
coeff_var_agri_prod_rural_no_F_W_subsidy_b , coeff_var_agri_prod_urban_no_F_W_subsidy_b, 
p90_wealth_no_F_W_subsidy_b,p99_wealth_no_F_W_subsidy_b,p90_cons_no_F_W_subsidy_b_rural,p99_cons_no_F_W_subsidy_b_rural,p90_cons_no_F_W_subsidy_b_urban,p99_cons_no_F_W_subsidy_b_urban,p90_income_no_F_W_subsidy_b_rural,
p99_income_no_F_W_subsidy_b_rural,p90_income_no_F_W_subsidy_b_urban,p99_income_no_F_W_subsidy_b_urban,wealth_of_workers_no_F_W_subsidy_b,
wealth_of_staples_no_F_W_subsidy_b,wealth_of_cashcrop_no_F_W_subsidy_b,
c_B_worker_sum_no_F_W_subsidy_b,c_B_staple_sum_no_F_W_subsidy_b,c_B_cashcrop_sum_no_F_W_subsidy_b,c_S_worker_sum_no_F_W_subsidy_b,c_S_staple_sum_no_F_W_subsidy_b ,c_S_cashcrop_sum_no_F_W_subsidy_b,
transaction_cost_staple_sum_no_F_W_subsidy_b,transaction_cost_cashcrop_sum_no_F_W_subsidy_b,transaction_cost_worker_sum_no_F_W_subsidy_b,c_M_worker_sum_no_F_W_subsidy_b,c_M_staple_sum_no_F_W_subsidy_b,c_M_cashcrop_sum_no_F_W_subsidy_b
,MPX_mean_log_no_F_W_subsidy_b, MPX_mean_staples_S_log_no_F_W_subsidy_b,MPX_mean_cashcrop_log_no_F_W_subsidy_b
, APland_mean_log_no_F_W_subsidy_b,APland_mean_cashcrop_log_no_F_W_subsidy_b, APland_mean_staples_S_log_no_F_W_subsidy_b,var_APland_no_F_W_subsidy_b,var_APland_cashcrop_no_F_W_subsidy_b,var_APland_staples_S_no_F_W_subsidy_b,
c_S_W_fine_no_F_W_subsidy_b,c_B_W_fine_no_F_W_subsidy_b,c_M_W_fine_no_F_W_subsidy_b,c_S_S_fine_no_F_W_subsidy_b,c_B_S_fine_no_F_W_subsidy_b,c_M_S_fine_no_F_W_subsidy_b,c_S_B_fine_no_F_W_subsidy_b,c_B_B_fine_no_F_W_subsidy_b,c_M_B_fine_no_F_W_subsidy_b) = details_model(prices_no_F_W_subsidy_b,no_F_W_parameter,2,moments,1.0,foreign_supply_capital_subsidy_b);


#    Subsidy equilibrium with balanced budget + No FM_B
prices_no_FM_B_subsidy_b = [   1.4805615707512334,
0.26962104767974854,
0.16687937137711306]
no_FM_B_parameter = copy(Baseline_parameter);
no_FM_B_parameter.FM_B= 0.0;
(residual_goods_no_FM_B_subsidy_b, stat_distr_no_FM_B_subsidy_b, cons_fine_local_no_FM_B_subsidy_b, a_prime_fine_local_no_FM_B_subsidy_b,future_occupation_fine_local_no_FM_B_subsidy_b,x_S_S_fine_no_FM_B_subsidy_b,x_SC_fine_no_FM_B_subsidy_b,x_BC_fine_no_FM_B_subsidy_b, coeff_no_FM_B_subsidy_b,
transaction_cost_loss_no_FM_B_subsidy_b,nominal_GDP_no_FM_B_subsidy_b,welfare_val_no_FM_B_subsidy_b,Import_value_no_FM_B_subsidy_b,Export_value_no_FM_B_subsidy_b,current_worker_pop_no_FM_B_subsidy_b,current_staple_pop_no_FM_B_subsidy_b,current_cashcrop_pop_no_FM_B_subsidy_b,
marketable_agr_surplus_share_no_FM_B_subsidy_b,exportshare_cashcrop_no_FM_B_subsidy_b,
fraction_model_no_FM_B_subsidy_b,program_spending_no_FM_B_subsidy_b,prod_value_improvement_no_FM_B_subsidy_b,share_selling_increase_no_FM_B_subsidy_b,exp_ratio_model_no_FM_B_subsidy_b,mig_rate_model_no_FM_B_subsidy_b,rural_pop_only_staples_model_no_FM_B_subsidy_b,rural_pop_only_cashcrop_model_no_FM_B_subsidy_b,
mean_land_share_to_staples_among_cc_model_no_FM_B_subsidy_b,urban_rural_inc_ratio_model_no_FM_B_subsidy_b,urban_rural_wealth_ratio_model_no_FM_B_subsidy_b,urban_rural_consumption_ratio_model_no_FM_B_subsidy_b,
p90_wealth_rural_no_FM_B_subsidy_b,p90_wealth_urban_no_FM_B_subsidy_b,p99_wealth_rural_no_FM_B_subsidy_b,p99_wealth_urban_no_FM_B_subsidy_b,p90_cons_tmp_no_FM_B_subsidy_b,p90_income_tmp_no_FM_B_subsidy_b,p99_cons_tmp_no_FM_B_subsidy_b,p99_income_tmp_no_FM_B_subsidy_b,
staple_productivity_no_FM_B_subsidy_b,cashcrop_productivity_no_FM_B_subsidy_b,manuf_productivity_no_FM_B_subsidy_b,relative_land_to_staples_no_FM_B_subsidy_b,relative_land_to_cashcrop_no_FM_B_subsidy_b,share_constrained_cashcrop_no_FM_B_subsidy_b,var_MPX_staples_S_no_FM_B_subsidy_b,var_MPX_cashcrop_B_no_FM_B_subsidy_b,var_MPX_cashcrop_S_no_FM_B_subsidy_b,
share_constrained_staple_no_FM_B_subsidy_b,APG_no_FM_B_subsidy_b,urban_rural_consumption_ratio_model_real_no_FM_B_subsidy_b,aggregate_consumption_no_FM_B_subsidy_b,
worker_pop_effective_no_FM_B_subsidy_b,prod_manuf_no_FM_B_subsidy_b,total_entry_cost_no_FM_B_subsidy_b,prod_staple_no_FM_B_subsidy_b,prod_cashcrop_no_FM_B_subsidy_b,input_staple_no_FM_B_subsidy_b,input_cashcrop_no_FM_B_subsidy_b,
total_maintenance_cost_no_FM_B_subsidy_b,current_account_residual_no_FM_B_subsidy_b,fraction_cashcrop_suboptimal_model_no_FM_B_subsidy_b,V_saved_no_FM_B_subsidy_b
,avg_labor_prod_rural_no_FM_B_subsidy_b,avg_labor_prod_urban_no_FM_B_subsidy_b,avg_agri_prod_rural_no_FM_B_subsidy_b,avg_agri_prod_urban_no_FM_B_subsidy_b,
var_MPX_cashcrop_no_FM_B_subsidy_b ,var_MPX_no_FM_B_subsidy_b ,TFP_no_FM_B_subsidy_b ,YL_manuf_no_FM_B_subsidy_b  , 
YL_agr_no_FM_B_subsidy_b ,coeff_var_labor_prod_rural_no_FM_B_subsidy_b ,coeff_var_labor_prod_urban_no_FM_B_subsidy_b ,
coeff_var_agri_prod_rural_no_FM_B_subsidy_b , coeff_var_agri_prod_urban_no_FM_B_subsidy_b, 
p90_wealth_no_FM_B_subsidy_b,p99_wealth_no_FM_B_subsidy_b,p90_cons_no_FM_B_subsidy_b_rural,p99_cons_no_FM_B_subsidy_b_rural,p90_cons_no_FM_B_subsidy_b_urban,p99_cons_no_FM_B_subsidy_b_urban,p90_income_no_FM_B_subsidy_b_rural,
p99_income_no_FM_B_subsidy_b_rural,p90_income_no_FM_B_subsidy_b_urban,p99_income_no_FM_B_subsidy_b_urban,
wealth_of_workers_no_FM_B_subsidy_b,wealth_of_staples_no_FM_B_subsidy_b,wealth_of_cashcrop_no_FM_B_subsidy_b,
c_B_worker_sum_no_FM_B_subsidy_b,c_B_staple_sum_no_FM_B_subsidy_b,c_B_cashcrop_sum_no_FM_B_subsidy_b,c_S_worker_sum_no_FM_B_subsidy_b,c_S_staple_sum_no_FM_B_subsidy_b ,c_S_cashcrop_sum_no_FM_B_subsidy_b,
transaction_cost_staple_sum_no_FM_B_subsidy_b,transaction_cost_cashcrop_sum_no_FM_B_subsidy_b,transaction_cost_worker_sum_no_FM_B_subsidy_b,c_M_worker_sum_no_FM_B_subsidy_b,c_M_staple_sum_no_FM_B_subsidy_b,c_M_cashcrop_sum_no_FM_B_subsidy_b
,MPX_mean_log_no_FM_B_subsidy_b, MPX_mean_staples_S_log_no_FM_B_subsidy_b,MPX_mean_cashcrop_log_no_FM_B_subsidy_b
, APland_mean_log_no_FM_B_subsidy_b,APland_mean_cashcrop_log_no_FM_B_subsidy_b, APland_mean_staples_S_log_no_FM_B_subsidy_b,var_APland_no_FM_B_subsidy_b,var_APland_cashcrop_no_FM_B_subsidy_b,var_APland_staples_S_no_FM_B_subsidy_b,
c_S_W_fine_no_FM_B_subsidy_b,c_B_W_fine_no_FM_B_subsidy_b,c_M_W_fine_no_FM_B_subsidy_b,c_S_S_fine_no_FM_B_subsidy_b,c_B_S_fine_no_FM_B_subsidy_b,c_M_S_fine_no_FM_B_subsidy_b,c_S_B_fine_no_FM_B_subsidy_b,c_B_B_fine_no_FM_B_subsidy_b,c_M_B_fine_no_FM_B_subsidy_b) = details_model(prices_no_FM_B_subsidy_b,no_FM_B_parameter,2,moments,1.0,foreign_supply_capital_subsidy_b);

#    Subsidy equilibrium with balanced budget + No κ
prices_no_κ_subsidy_b =  [   1.514071468437403,
0.2803054849913619,
0.2617382599984764]; #!
no_κ_parameter_subsidy_b = copy(Baseline_parameter);
no_κ_parameter_subsidy_b.κ= 10.0;
(residual_goods_no_κ_subsidy_b, stat_distr_no_κ_subsidy_b, cons_fine_local_no_κ_subsidy_b, a_prime_fine_local_no_κ_subsidy_b,future_occupation_fine_local_no_κ_subsidy_b,x_S_S_fine_no_κ_subsidy_b,x_SC_fine_no_κ_subsidy_b,x_BC_fine_no_κ_subsidy_b, coeff_no_κ_subsidy_b,
transaction_cost_loss_no_κ_subsidy_b,nominal_GDP_no_κ_subsidy_b,welfare_val_no_κ_subsidy_b,Import_value_no_κ_subsidy_b,Export_value_no_κ_subsidy_b,current_worker_pop_no_κ_subsidy_b,current_staple_pop_no_κ_subsidy_b,current_cashcrop_pop_no_κ_subsidy_b,
marketable_agr_surplus_share_no_κ_subsidy_b,exportshare_cashcrop_no_κ_subsidy_b,
fraction_model_no_κ_subsidy_b,program_spending_no_κ_subsidy_b,prod_value_improvement_no_κ_subsidy_b,share_selling_increase_no_κ_subsidy_b,exp_ratio_model_no_κ_subsidy_b,mig_rate_model_no_κ_subsidy_b,rural_pop_only_staples_model_no_κ_subsidy_b,rural_pop_only_cashcrop_model_no_κ_subsidy_b,
mean_land_share_to_staples_among_cc_model_no_κ_subsidy_b,urban_rural_inc_ratio_model_no_κ_subsidy_b,urban_rural_wealth_ratio_model_no_κ_subsidy_b,urban_rural_consumption_ratio_model_no_κ_subsidy_b,
p90_wealth_rural_no_κ_subsidy_b,p90_wealth_urban_no_κ_subsidy_b,p99_wealth_rural_no_κ_subsidy_b,p99_wealth_urban_no_κ_subsidy_b,p90_cons_tmp_no_κ_subsidy_b,p90_income_tmp_no_κ_subsidy_b,p99_cons_tmp_no_κ_subsidy_b,p99_income_tmp_no_κ_subsidy_b,
staple_productivity_no_κ_subsidy_b,cashcrop_productivity_no_κ_subsidy_b,manuf_productivity_no_κ_subsidy_b,relative_land_to_staples_no_κ_subsidy_b,relative_land_to_cashcrop_no_κ_subsidy_b,share_constrained_cashcrop_no_κ_subsidy_b,var_MPX_staples_S_no_κ_subsidy_b,var_MPX_cashcrop_B_no_κ_subsidy_b,var_MPX_cashcrop_S_no_κ_subsidy_b,
share_constrained_staple_no_κ_subsidy_b,APG_no_κ_subsidy_b,urban_rural_consumption_ratio_model_real_no_κ_subsidy_b,aggregate_consumption_no_κ_subsidy_b,
worker_pop_effective_no_κ_subsidy_b,prod_manuf_no_κ_subsidy_b,total_entry_cost_no_κ_subsidy_b,prod_staple_no_κ_subsidy_b,prod_cashcrop_no_κ_subsidy_b,input_staple_no_κ_subsidy_b,input_cashcrop_no_κ_subsidy_b,
total_maintenance_cost_no_κ_subsidy_b,current_account_residual_no_κ_subsidy_b,fraction_cashcrop_suboptimal_model_no_κ_subsidy_b,V_saved_no_κ_subsidy_b
,avg_labor_prod_rural_no_κ_subsidy_b,avg_labor_prod_urban_no_κ_subsidy_b,avg_agri_prod_rural_no_κ_subsidy_b,avg_agri_prod_urban_no_κ_subsidy_b,
var_MPX_cashcrop_no_κ_subsidy_b ,var_MPX_no_κ_subsidy_b ,TFP_no_κ_subsidy_b ,YL_manuf_no_κ_subsidy_b  , 
YL_agr_no_κ_subsidy_b ,coeff_var_labor_prod_rural_no_κ_subsidy_b ,coeff_var_labor_prod_urban_no_κ_subsidy_b ,
coeff_var_agri_prod_rural_no_κ_subsidy_b , coeff_var_agri_prod_urban_no_κ_subsidy_b ,
p90_wealth_no_κ_subsidy_b,p99_wealth_no_κ_subsidy_b,p90_cons_no_κ_subsidy_b_rural,p99_cons_no_κ_subsidy_b_rural,p90_cons_no_κ_subsidy_b_urban,p99_cons_no_κ_subsidy_b_urban,p90_income_no_κ_subsidy_b_rural,
p99_income_no_κ_subsidy_b_rural,p90_income_no_κ_subsidy_b_urban,p99_income_no_κ_subsidy_b_urban,
wealth_of_workers_no_κ_subsidy_b,wealth_of_staples_no_κ_subsidy_b,wealth_of_cashcrop_no_κ_subsidy_b,
c_B_worker_sum_no_κ_subsidy_b,c_B_staple_sum_no_κ_subsidy_b,c_B_cashcrop_sum_no_κ_subsidy_b,c_S_worker_sum_no_κ_subsidy_b,c_S_staple_sum_no_κ_subsidy_b ,c_S_cashcrop_sum_no_κ_subsidy_b,
transaction_cost_staple_sum_no_κ_subsidy_b,transaction_cost_cashcrop_sum_no_κ_subsidy_b,transaction_cost_worker_sum_no_κ_subsidy_b,c_M_worker_sum_no_κ_subsidy_b,c_M_staple_sum_no_κ_subsidy_b,c_M_cashcrop_sum_no_κ_subsidy_b
,MPX_mean_log_no_κ_subsidy_b, MPX_mean_staples_S_log_no_κ_subsidy_b,MPX_mean_cashcrop_log_no_κ_subsidy_b
, APland_mean_log_no_κ_subsidy_b,APland_mean_cashcrop_log_no_κ_subsidy_b, APland_mean_staples_S_log_no_κ_subsidy_b,var_APland_no_κ_subsidy_b,var_APland_cashcrop_no_κ_subsidy_b,var_APland_staples_S_no_κ_subsidy_b,
c_S_W_fine_no_κ_subsidy_b,c_B_W_fine_no_κ_subsidy_b,c_M_W_fine_no_κ_subsidy_b,c_S_S_fine_no_κ_subsidy_b,c_B_S_fine_no_κ_subsidy_b,c_M_S_fine_no_κ_subsidy_b,c_S_B_fine_no_κ_subsidy_b,c_B_B_fine_no_κ_subsidy_b,c_M_B_fine_no_κ_subsidy_b) = details_model(prices_no_κ_subsidy_b,no_κ_parameter_subsidy_b,2,moments,1.0,foreign_supply_capital_subsidy_b);

# Infrastructure 
infra_parameter_nsp_nb = copy(Baseline_parameter);
infra_parameter_nsp_nb.τ_S=-0;
infra_parameter_nsp_nb.Q_S = 0.7;
prices_inf =  [ 1.190206255203472,
0.1745527606893067];#,2.505662787966534
(residual_goods_inf, stat_distr_inf, cons_fine_local_inf, a_prime_fine_local_inf,future_occupation_fine_local_inf,x_S_S_fine_inf,x_SC_fine_inf,x_BC_fine_inf, coeff_inf,
transaction_cost_loss_inf,nominal_GDP_inf,welfare_val_inf,Import_value_inf,Export_value_inf,current_worker_pop_inf,current_staple_pop_inf,current_cashcrop_pop_inf,
marketable_agr_surplus_share_inf,exportshare_cashcrop_inf,
fraction_model_inf,program_spending_inf,prod_value_improvement_inf,share_selling_increase_inf,exp_ratio_model_inf,mig_rate_model_inf,rural_pop_only_staples_model_inf,rural_pop_only_cashcrop_model_inf,
mean_land_share_to_staples_among_cc_model_inf,urban_rural_inc_ratio_model_inf,urban_rural_wealth_ratio_model_inf,urban_rural_consumption_ratio_model_inf,
p90_wealth_rural_inf,p90_wealth_urban_inf,p99_wealth_rural_inf,p99_wealth_urban_inf,p90_cons_tmp_inf,p90_income_tmp_inf,p99_cons_tmp_inf,p99_income_tmp_inf,
staple_productivity_inf,cashcrop_productivity_inf,manuf_productivity_inf,relative_land_to_staples_inf,relative_land_to_cashcrop_inf,share_constrained_cashcrop_inf,var_MPX_staples_S_inf,var_MPX_cashcrop_B_inf,var_MPX_cashcrop_S_inf,
share_constrained_staple_inf,APG_inf,urban_rural_consumption_ratio_model_real_inf,aggregate_consumption_inf,
worker_pop_effective_inf,prod_manuf_inf,total_entry_cost_inf,prod_staple_inf,prod_cashcrop_inf,input_staple_inf,input_cashcrop_inf,
total_maintenance_cost_inf,current_account_residual_inf,fraction_cashcrop_suboptimal_model_inf,V_saved_inf,
avg_labor_prod_rural_inf,avg_labor_prod_urban_inf,avg_agri_prod_rural_inf,avg_agri_prod_urban_inf,
var_MPX_cashcrop_inf ,var_MPX_inf ,TFP_inf ,YL_manuf_inf  , 
YL_agr_inf ,coeff_var_labor_prod_rural_inf ,coeff_var_labor_prod_urban_inf ,
coeff_var_agri_prod_rural_inf , coeff_var_agri_prod_urban_inf ,
p90_wealth_inf,p99_wealth_inf,p90_cons_inf_rural,p99_cons_inf_rural,p90_cons_inf_urban,p99_cons_inf_urban,p90_income_inf_rural,
p99_income_inf_rural,p90_income_inf_urban,p99_income_inf_urban,
wealth_of_workers_inf,wealth_of_staples_inf,wealth_of_cashcrop_inf,
c_B_worker_sum_inf,c_B_staple_sum_inf,c_B_cashcrop_sum_inf,c_S_worker_sum_inf,c_S_staple_sum_inf ,c_S_cashcrop_sum_inf,
transaction_cost_staple_sum_inf,transaction_cost_cashcrop_sum_inf,transaction_cost_worker_sum_inf,c_M_worker_sum_inf,c_M_staple_sum_inf,c_M_cashcrop_sum_inf
,MPX_mean_log_inf, MPX_mean_staples_S_log_inf,MPX_mean_cashcrop_log_inf
, APland_mean_log_inf,APland_mean_cashcrop_log_inf, APland_mean_staples_S_log_inf,var_APland_inf,var_APland_cashcrop_inf,var_APland_staples_S_inf,
c_S_W_fine_inf,c_B_W_fine_inf,c_M_W_fine_inf,c_S_S_fine_inf,c_B_S_fine_inf,c_M_S_fine_inf,c_S_B_fine_inf,c_B_B_fine_inf,c_M_B_fine_inf) = details_model(prices_inf,infra_parameter_nsp_nb,2,moments,0.0,foreign_supply_capital_subsidy_b);

#program_spending_subsidy_nb * nominal_GDP_subsidy_nb - transaction_cost_loss_inf/ (infra_parameter_nsp_nb.Q_S)*(Baseline_parameter.Q_S-infra_parameter_nsp_nb.Q_S)
transaction_cost_loss_inf*prod_staple_inf/ (infra_parameter_nsp_nb.Q_S)*(Baseline_parameter.Q_S-infra_parameter_nsp_nb.Q_S) / nominal_GDP_inf

infra_parameter_sp_nb = copy(Baseline_parameter);
infra_parameter_sp_nb.τ_S=-0;
infra_parameter_sp_nb.Q_S = 0.7;
infra_parameter_sp_nb.F_W = Baseline_parameter.F_W * (infra_parameter_sp_nb.Q_S / Baseline_parameter.Q_S)
prices_inf_sp = [1.1723046609628551,
0.12471486958333933]#
#residual = f_solve(prices);
(residual_goods_inf_sp, stat_distr_inf_sp, cons_fine_local_inf_sp, a_prime_fine_local_inf_sp,future_occupation_fine_local_inf_sp,x_S_S_fine_inf_sp,x_SC_fine_inf_sp,x_BC_fine_inf_sp, coeff_inf_sp,
        transaction_cost_loss_inf_sp,nominal_GDP_inf_sp,welfare_val_inf_sp,Import_value_inf_sp,Export_value_inf_sp,current_worker_pop_inf_sp,current_staple_pop_inf_sp,current_cashcrop_pop_inf_sp,
        marketable_agr_surplus_share_inf_sp,exportshare_cashcrop_inf_sp,
        fraction_model_inf_sp,program_spending_inf_sp,prod_value_improvement_inf_sp,share_selling_increase_inf_sp,exp_ratio_model_inf_sp,mig_rate_model_inf_sp,rural_pop_only_staples_model_inf_sp,rural_pop_only_cashcrop_model_inf_sp,
        mean_land_share_to_staples_among_cc_model_inf_sp,urban_rural_inc_ratio_model_inf_sp,urban_rural_wealth_ratio_model_inf_sp,urban_rural_consumption_ratio_model_inf_sp,
        p90_wealth_rural_inf_sp,p90_wealth_urban_inf_sp,p99_wealth_rural_inf_sp,p99_wealth_urban_inf_sp,p90_cons_tmp_inf_sp,p90_income_tmp_inf_sp,p99_cons_tmp_inf_sp,p99_income_tmp_inf_sp,
        staple_productivity_inf_sp,cashcrop_productivity_inf_sp,manuf_productivity_inf_sp,relative_land_to_staples_inf_sp,relative_land_to_cashcrop_inf_sp,share_constrained_cashcrop_inf_sp,var_MPX_staples_S_inf_sp,var_MPX_cashcrop_B_inf_sp,var_MPX_cashcrop_S_inf_sp,
        share_constrained_staple_inf_sp,APG_inf_sp,urban_rural_consumption_ratio_model_real_inf_sp,aggregate_consumption_inf_sp,
        worker_pop_effective_inf_sp,prod_manuf_inf_sp,total_entry_cost_inf_sp,prod_staple_inf_sp,prod_cashcrop_inf_sp,input_staple_inf_sp,input_cashcrop_inf_sp,
        total_maintenance_cost_inf_sp,current_account_residual_inf_sp,fraction_cashcrop_suboptimal_model_inf_sp,V_saved_inf_sp,
        avg_labor_prod_rural_inf_sp,avg_labor_prod_urban_inf_sp,avg_agri_prod_rural_inf_sp,avg_agri_prod_urban_inf_sp,
        var_MPX_cashcrop_inf_sp ,var_MPX_inf_sp ,TFP_inf_sp ,YL_manuf_inf_sp  , 
        YL_agr_inf_sp ,coeff_var_labor_prod_rural_inf_sp ,coeff_var_labor_prod_urban_inf_sp ,
        coeff_var_agri_prod_rural_inf_sp , coeff_var_agri_prod_urban_inf_sp ,
        p90_wealth_inf_sp,p99_wealth_inf_sp,p90_cons_inf_sp_rural,p99_cons_inf_sp_rural,p90_cons_inf_sp_urban,p99_cons_inf_sp_urban,p90_income_inf_sp_rural,
        p99_income_inf_sp_rural,p90_income_inf_sp_urban,p99_income_inf_sp_urban,
        wealth_of_workers_inf_sp,wealth_of_staples_inf_sp,wealth_of_cashcrop_inf_sp,
        c_B_worker_sum_inf_sp,c_B_staple_sum_inf_sp,c_B_cashcrop_sum_inf_sp,c_S_worker_sum_inf_sp,c_S_staple_sum_inf_sp ,c_S_cashcrop_sum_inf_sp,
        transaction_cost_staple_sum_inf_sp,transaction_cost_cashcrop_sum_inf_sp,transaction_cost_worker_sum_inf_sp,c_M_worker_sum_inf_sp,c_M_staple_sum_inf_sp,c_M_cashcrop_sum_inf_sp
        ,MPX_mean_log_inf_sp, MPX_mean_staples_S_log_inf_sp,MPX_mean_cashcrop_log_inf_sp
        , APland_mean_log_inf_sp,APland_mean_cashcrop_log_inf_sp, APland_mean_staples_S_log_inf_sp,var_APland_inf_sp,var_APland_cashcrop_inf_sp,var_APland_staples_S_inf_sp,
c_S_W_fine_inf_sp,c_B_W_fine_inf_sp,c_M_W_fine_inf_sp,c_S_S_fine_inf_sp,c_B_S_fine_inf_sp,c_M_S_fine_inf_sp,c_S_B_fine_inf_sp,c_B_B_fine_inf_sp,c_M_B_fine_inf_sp) = details_model(prices_inf_sp,infra_parameter_sp_nb,2,moments,0.0,foreign_supply_capital_subsidy_b);

# Obtain the results for optimal subsidy:

# # This part is only needed for different tauS vectors
# no_taus1 = 11
# prices_subsidy_b_grid1 = ones(3,no_taus1);
# prices_subsidy_b_grid1[1,:] = [1.50193 ,  1.41901 ,   1.37031  ,  1.32695  ,  1.29374  ,  1.2656  ,   1.24367  ,  1.22488 ,  1.20621  ,  1.18598 ,   1.1761 ];
# prices_subsidy_b_grid1[2,:] = [0.252278 , 0.23388  ,  0.229202 ,  0.215522 ,  0.217217 ,  0.205816 ,  0.205173 ,  0.203484 , 0.207593 ,  0.192035 ,  0.192054];
# prices_subsidy_b_grid1[3,:] = [0.152596 , 0.0931243 , 0.0682528 , 0.0489459 , 0.0348802 , 0.0247181 , 0.0176974 , 0.011634 , 0.0063424 , 0.0021779 , 0.0 ];


# τ_grid1 = zeros(no_taus1);
# τ_grid1[1:(no_taus1 - 1) ] = range(Baseline_parameter.τ_S,-0.05,no_taus1-1)

# no_taus2= 21
# prices_subsidy_b_grid2 = ones(3,no_taus2);
# prices_subsidy_b_grid2[1,:] = [1.50193 ,  1.46548 ,  1.42793  , 1.40183  , 1.37866  ,  1.35987  ,  1.34164  ,  1.32354  ,  1.30643 ,   1.29362  ,  1.28082   , 1.26905  ,  1.25875  ,  1.2467   ,  1.23701  ,  1.22909  ,  1.21865 ,   1.21536  ,   1.20605  ,   1.19481   ,  1.1761  ];       
# prices_subsidy_b_grid2[2,:] = [0.252278 , 0.233978 , 0.233412 , 0.232739 , 0.232361 ,  0.213076  , 0.212905 ,  0.215287 ,  0.204994  , 0.204275 ,  0.204633 ,  0.205771 ,  0.207009  , 0.207411 ,  0.209514 ,  0.209253  , 0.192362 ,  0.189848  ,  0.189807  ,  0.191641  ,  0.192054   ];    
# prices_subsidy_b_grid2[3,:] = [0.152596 , 0.129457 , 0.099764 , 0.084152 , 0.0725594 , 0.0642034 , 0.0556398 , 0.0474308 , 0.0409965 , 0.0358801 , 0.0299909 , 0.0258702 , 0.0222282 , 0.0189747 , 0.0157095 , 0.0131466 , 0.0108565 , 0.00901757 , 0.00679134 , 0.00452941 , 0.0 ];


# τ_grid2 = zeros(no_taus2);
# τ_grid2[1:(no_taus2 - 1) ] = range(Baseline_parameter.τ_S,-0.1,no_taus2-1)

# no_taus = no_taus2 + no_taus1 - 2;
# τ_grid = zeros(no_taus);
# prices_subsidy_b_grid = ones(3,no_taus); 
# prices_subsidy_b_grid[:,1:(no_taus1 - 1)] = prices_subsidy_b_grid1[:,1:(no_taus1 - 1) ] ;
# prices_subsidy_b_grid[:,no_taus1:(end)] = prices_subsidy_b_grid2[:,2:(no_taus2) ] ;
# τ_grid[1:(no_taus1 - 1)] = τ_grid1[1:(no_taus1 - 1) ] ;
# τ_grid[no_taus1:(end - 1)] = τ_grid2[2:(no_taus2 - 1) ] ;

# ordered_tauS_index = sortperm(τ_grid);
# τ_grid_ordered = τ_grid[ordered_tauS_index]
# prices_subsidy_b_grid_ordered = prices_subsidy_b_grid[:,ordered_tauS_index]
# τ_grid = copy(τ_grid_ordered);
# prices_subsidy_b_grid = copy(prices_subsidy_b_grid_ordered);

### Now the two objects are saved:
prices_subsidy_b_grid = [1.5182148598312672 1.4748615289082854 1.4389313172837825 1.410732954524286 1.390264709095618 1.3688114420290358 1.3436655727518898 1.3271570823425125 1.312778814101722 1.3003105888992221 1.284946210796012 1.2714091997394257 1.2599461971286845 1.2479933342455625 1.2388104401541415 1.2294244830748497 1.2217938803468038 1.2132098804982514 1.2099699888601618 1.1995655457878038 1.1882831767847994; 0.27262899815531444 0.26338424759605666 0.245822286882918 0.2442836837960706 0.21752367635207415 0.21670507564964162 0.2061107155376924 0.2036475392226677 0.20098618728681622 0.19862949627869536 0.19659831128032512 0.19476856375812163 0.19323999476869438 0.18933334499100343 0.19016660308519126 0.18807703128020226 0.1869710641961219 0.1857564570225632 0.18361768757377586 0.18414175648950032 0.18349666056314162; 0.18860594848809528 0.14681832007063747 0.12372332717865375 0.10211507272581569 0.09328546623799094 0.0770503430189069 0.06580378586580023 0.055857350780308554 0.04822701987252334 0.04189534576885402 0.03530977698358126 0.029721337552662572 0.0251658618411578 0.02075905911514478 0.016733799327583475 0.013639766449854727 0.010610113658055436 0.007772421378081955 0.005375731191350952 0.002777150926899589 0.0]
no_taus = 21;
τ_grid = range(Baseline_parameter.τ_S,-0.05,length = no_taus-1)
τ_grid1 = zeros(no_taus);
τ_grid1[1:(no_taus-1)] = τ_grid;
τ_grid = τ_grid1;
residual_goods_subsidy_b_grid = ones(6,no_taus);
stat_distr_subsidy_b_grid = ones(Baseline_parameter.ns_fine*3,no_taus);
cons_fine_local_subsidy_b_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
a_prime_fine_local_subsidy_b_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
future_occupation_fine_local_subsidy_b_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
x_S_S_fine_subsidy_b_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
x_SC_fine_subsidy_b_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
x_BC_fine_subsidy_b_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
coeff_subsidy_b_grid = ones(Baseline_parameter.ns,3,no_taus);
transaction_cost_loss_subsidy_b_grid = ones(no_taus);
nominal_GDP_subsidy_b_grid= ones(no_taus);
welfare_val_subsidy_b_grid =  ones(Baseline_parameter.ns_fine*3,no_taus);
Import_value_subsidy_b_grid = ones(no_taus);
Export_value_subsidy_b_grid = ones(no_taus);
current_worker_pop_subsidy_b_grid = ones(no_taus);
current_staple_pop_subsidy_b_grid = ones(no_taus);
current_cashcrop_pop_subsidy_b_grid = ones(no_taus);
marketable_agr_surplus_share_subsidy_b_grid = ones(no_taus);
exportshare_cashcrop_subsidy_b_grid = ones(no_taus);
fraction_model_subsidy_b_grid= ones(no_taus);
program_spending_subsidy_b_grid= ones(no_taus);
prod_value_improvement_subsidy_b_grid= ones(no_taus);
share_selling_increase_subsidy_b_grid= ones(no_taus);
exp_ratio_model_subsidy_b_grid= ones(no_taus);
mig_rate_model_subsidy_b_grid= ones(no_taus);
rural_pop_only_staples_model_subsidy_b_grid= ones(no_taus);
rural_pop_only_cashcrop_model_subsidy_b_grid= ones(no_taus);
mean_land_share_to_staples_among_cc_model_subsidy_b_grid= ones(no_taus);
urban_rural_inc_ratio_model_subsidy_b_grid= ones(no_taus);
urban_rural_wealth_ratio_model_subsidy_b_grid= ones(no_taus);
urban_rural_consumption_ratio_model_subsidy_b_grid= ones(no_taus);
p90_wealth_rural_subsidy_b_grid= ones(no_taus);
p90_wealth_urban_subsidy_b_grid= ones(no_taus);
p99_wealth_rural_subsidy_b_grid= ones(no_taus);
p99_wealth_urban_subsidy_b_grid= ones(no_taus);
p90_cons_tmp_subsidy_b_grid= ones(no_taus);
p90_income_tmp_subsidy_b_grid= ones(no_taus);
p99_cons_tmp_subsidy_b_grid= ones(no_taus);
p99_income_tmp_subsidy_b_grid= ones(no_taus);
staple_productivity_subsidy_b_grid= ones(no_taus);
cashcrop_productivity_subsidy_b_grid= ones(no_taus);
manuf_productivity_subsidy_b_grid= ones(no_taus);
relative_land_to_staples_subsidy_b_grid= ones(no_taus);
relative_land_to_cashcrop_subsidy_b_grid= ones(no_taus);
share_constrained_cashcrop_subsidy_b_grid= ones(no_taus);
var_MPX_staples_S_subsidy_b_grid= ones(no_taus);
var_MPX_cashcrop_B_subsidy_b_grid= ones(no_taus);
var_MPX_cashcrop_S_subsidy_b_grid= ones(no_taus);
share_constrained_staple_subsidy_b_grid= ones(no_taus);
APG_subsidy_b_grid= ones(no_taus);
urban_rural_consumption_ratio_model_real_subsidy_b_grid= ones(no_taus);
aggregate_consumption_subsidy_b_grid= ones(no_taus);
worker_pop_effective_subsidy_b_grid= ones(no_taus);
prod_manuf_subsidy_b_grid= ones(no_taus);
total_entry_cost_subsidy_b_grid= ones(no_taus);
prod_staple_subsidy_b_grid= ones(no_taus);
prod_cashcrop_subsidy_b_grid= ones(no_taus);
input_staple_subsidy_b_grid= ones(no_taus);
input_cashcrop_subsidy_b_grid= ones(no_taus);
total_maintenance_cost_subsidy_b_grid= ones(no_taus);
current_account_residual_subsidy_b_grid= ones(no_taus);
fraction_cashcrop_suboptimal_model_subsidy_b_grid = ones(no_taus);
welfare_subsidy_b_grid= ones(no_taus);
V_saved_b_grid = ones(Baseline_parameter.ns_fine, 3, no_taus);
avg_labor_prod_rural_subsidy_b_grid= ones(no_taus);
avg_labor_prod_urban_subsidy_b_grid= ones(no_taus);
avg_agri_prod_rural_subsidy_b_grid= ones(no_taus);
avg_agri_prod_urban_subsidy_b_grid= ones(no_taus);
var_MPX_cashcrop_subsidy_b_grid= ones(no_taus);
var_MPX_subsidy_b_grid= ones(no_taus);
TFP_subsidy_b_grid= ones(no_taus);
YL_manuf_subsidy_b_grid= ones(no_taus);
YL_agr_subsidy_b_grid= ones(no_taus);
coeff_var_labor_prod_rural_subsidy_b_grid= ones(no_taus);
coeff_var_labor_prod_urban_subsidy_b_grid= ones(no_taus);
coeff_var_agri_prod_rural_subsidy_b_grid= ones(no_taus);
coeff_var_agri_prod_urban_subsidy_b_grid= ones(no_taus);
p90_wealth_subsidy_b_grid= ones(no_taus);
p99_wealth_subsidy_b_grid= ones(no_taus);
p90_cons_subsidy_b_grid_rural= ones(no_taus);
p99_cons_subsidy_b_grid_rural= ones(no_taus);
p90_cons_subsidy_b_grid_urban= ones(no_taus);
p99_cons_subsidy_b_grid_urban= ones(no_taus);
p90_income_subsidy_b_grid_rural= ones(no_taus);
p99_income_subsidy_b_grid_rural= ones(no_taus);
p90_income_subsidy_b_grid_urban= ones(no_taus);
p99_income_subsidy_b_grid_urban= ones(no_taus);
wealth_of_workers_subsidy_b_grid= ones(no_taus);
wealth_of_staples_subsidy_b_grid= ones(no_taus);
wealth_of_cashcrop_subsidy_b_grid= ones(no_taus);
c_B_worker_sum_subsidy_b_grid= ones(no_taus);
c_B_staple_sum_subsidy_b_grid= ones(no_taus);
c_B_cashcrop_sum_subsidy_b_grid= ones(no_taus);
c_S_worker_sum_subsidy_b_grid= ones(no_taus);
c_S_staple_sum_subsidy_b_grid = ones(no_taus);
c_S_cashcrop_sum_subsidy_b_grid= ones(no_taus);
transaction_cost_staple_sum_subsidy_b_grid= ones(no_taus);
transaction_cost_cashcrop_sum_subsidy_b_grid= ones(no_taus);
transaction_cost_worker_sum_subsidy_b_grid= ones(no_taus);
c_M_worker_sum_subsidy_b_grid= ones(no_taus);
c_M_staple_sum_subsidy_b_grid= ones(no_taus);
c_M_cashcrop_sum_subsidy_b_grid= ones(no_taus);
MPX_mean_log_subsidy_b_grid= ones(no_taus);
MPX_mean_staples_S_log_subsidy_b_grid= ones(no_taus);
MPX_mean_cashcrop_log_subsidy_b_grid= ones(no_taus);
APland_mean_log_subsidy_b_grid= ones(no_taus);
APland_mean_cashcrop_log_subsidy_b_grid= ones(no_taus);
APland_mean_staples_S_log_subsidy_b_grid= ones(no_taus);
var_APland_subsidy_b_grid= ones(no_taus);
var_APland_cashcrop_subsidy_b_grid= ones(no_taus);
var_APland_staples_S_subsidy_b_grid= ones(no_taus);
c_S_W_fine_subsidy_b_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_B_W_fine_subsidy_b_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_M_W_fine_subsidy_b_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_S_S_fine_subsidy_b_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_B_S_fine_subsidy_b_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_M_S_fine_subsidy_b_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_S_B_fine_subsidy_b_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_B_B_fine_subsidy_b_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_M_B_fine_subsidy_b_grid= ones(Baseline_parameter.ns_fine,3,no_taus);

for iterate_loc = 1:no_taus
    parameters_tmp = copy(Baseline_parameter);
    parameters_tmp.τ_S = τ_grid[iterate_loc];
    println("Populate for " ,τ_grid[iterate_loc], "subsidy rate")
    (residual_goods_subsidy_b_grid[:,iterate_loc], stat_distr_subsidy_b_grid[:,iterate_loc], cons_fine_local_subsidy_b_grid[:,:,iterate_loc], a_prime_fine_local_subsidy_b_grid[:,:,iterate_loc],
    future_occupation_fine_local_subsidy_b_grid[:,:,iterate_loc],x_S_S_fine_subsidy_b_grid[:,:,iterate_loc],x_SC_fine_subsidy_b_grid[:,:,iterate_loc],x_BC_fine_subsidy_b_grid[:,:,iterate_loc], 
    coeff_subsidy_b_grid[:,:,iterate_loc],  transaction_cost_loss_subsidy_b_grid[iterate_loc],nominal_GDP_subsidy_b_grid[iterate_loc],welfare_val_subsidy_b_grid[:,iterate_loc],
    Import_value_subsidy_b_grid[iterate_loc],Export_value_subsidy_b_grid[iterate_loc],current_worker_pop_subsidy_b_grid[iterate_loc],current_staple_pop_subsidy_b_grid[iterate_loc],
    current_cashcrop_pop_subsidy_b_grid[iterate_loc], marketable_agr_surplus_share_subsidy_b_grid[iterate_loc],exportshare_cashcrop_subsidy_b_grid[iterate_loc],
    fraction_model_subsidy_b_grid[iterate_loc],program_spending_subsidy_b_grid[iterate_loc],prod_value_improvement_subsidy_b_grid[iterate_loc],share_selling_increase_subsidy_b_grid[iterate_loc],
    exp_ratio_model_subsidy_b_grid[iterate_loc],mig_rate_model_subsidy_b_grid[iterate_loc],rural_pop_only_staples_model_subsidy_b_grid[iterate_loc],
    rural_pop_only_cashcrop_model_subsidy_b_grid[iterate_loc],mean_land_share_to_staples_among_cc_model_subsidy_b_grid[iterate_loc],urban_rural_inc_ratio_model_subsidy_b_grid[iterate_loc],
    urban_rural_wealth_ratio_model_subsidy_b_grid[iterate_loc],urban_rural_consumption_ratio_model_subsidy_b_grid[iterate_loc],p90_wealth_rural_subsidy_b_grid[iterate_loc],
    p90_wealth_urban_subsidy_b_grid[iterate_loc],p99_wealth_rural_subsidy_b_grid[iterate_loc],p99_wealth_urban_subsidy_b_grid[iterate_loc],p90_cons_tmp_subsidy_b_grid[iterate_loc],
    p90_income_tmp_subsidy_b_grid[iterate_loc],p99_cons_tmp_subsidy_b_grid[iterate_loc],p99_income_tmp_subsidy_b_grid[iterate_loc],staple_productivity_subsidy_b_grid[iterate_loc],
    cashcrop_productivity_subsidy_b_grid[iterate_loc],manuf_productivity_subsidy_b_grid[iterate_loc],relative_land_to_staples_subsidy_b_grid[iterate_loc],
    relative_land_to_cashcrop_subsidy_b_grid[iterate_loc],share_constrained_cashcrop_subsidy_b_grid[iterate_loc],var_MPX_staples_S_subsidy_b_grid[iterate_loc],
    var_MPX_cashcrop_B_subsidy_b_grid[iterate_loc],var_MPX_cashcrop_S_subsidy_b_grid[iterate_loc],share_constrained_staple_subsidy_b_grid[iterate_loc],APG_subsidy_b_grid[iterate_loc],
    urban_rural_consumption_ratio_model_real_subsidy_b_grid[iterate_loc],aggregate_consumption_subsidy_b_grid[iterate_loc],
    worker_pop_effective_subsidy_b_grid[iterate_loc],prod_manuf_subsidy_b_grid[iterate_loc],total_entry_cost_subsidy_b_grid[iterate_loc],prod_staple_subsidy_b_grid[iterate_loc],prod_cashcrop_subsidy_b_grid[iterate_loc],input_staple_subsidy_b_grid[iterate_loc],input_cashcrop_subsidy_b_grid[iterate_loc],
    total_maintenance_cost_subsidy_b_grid[iterate_loc],current_account_residual_subsidy_b_grid[iterate_loc],fraction_cashcrop_suboptimal_model_subsidy_b_grid[iterate_loc],V_saved_b_grid[:,:,iterate_loc],
    avg_labor_prod_rural_subsidy_b_grid[iterate_loc],avg_labor_prod_urban_subsidy_b_grid[iterate_loc],avg_agri_prod_rural_subsidy_b_grid[iterate_loc],avg_agri_prod_urban_subsidy_b_grid[iterate_loc],
    var_MPX_cashcrop_subsidy_b_grid[iterate_loc] ,var_MPX_subsidy_b_grid[iterate_loc] ,TFP_subsidy_b_grid[iterate_loc] ,YL_manuf_subsidy_b_grid[iterate_loc]  , 
    YL_agr_subsidy_b_grid[iterate_loc] ,coeff_var_labor_prod_rural_subsidy_b_grid[iterate_loc] ,coeff_var_labor_prod_urban_subsidy_b_grid[iterate_loc] ,
    coeff_var_agri_prod_rural_subsidy_b_grid[iterate_loc] , coeff_var_agri_prod_urban_subsidy_b_grid[iterate_loc] ,
    p90_wealth_subsidy_b_grid[iterate_loc] ,p99_wealth_subsidy_b_grid[iterate_loc] ,p90_cons_subsidy_b_grid_rural[iterate_loc] ,p99_cons_subsidy_b_grid_rural[iterate_loc] ,p90_cons_subsidy_b_grid_urban[iterate_loc],p99_cons_subsidy_b_grid_urban[iterate_loc],p90_income_subsidy_b_grid_rural[iterate_loc] ,
    p99_income_subsidy_b_grid_rural[iterate_loc],p90_income_subsidy_b_grid_urban[iterate_loc],p99_income_subsidy_b_grid_urban[iterate_loc],
    wealth_of_workers_subsidy_b_grid[iterate_loc] ,wealth_of_staples_subsidy_b_grid[iterate_loc] ,wealth_of_cashcrop_subsidy_b_grid[iterate_loc] ,
    c_B_worker_sum_subsidy_b_grid[iterate_loc],c_B_staple_sum_subsidy_b_grid[iterate_loc],c_B_cashcrop_sum_subsidy_b_grid[iterate_loc],c_S_worker_sum_subsidy_b_grid[iterate_loc],c_S_staple_sum_subsidy_b_grid[iterate_loc] ,c_S_cashcrop_sum_subsidy_b_grid[iterate_loc],
    transaction_cost_staple_sum_subsidy_b_grid[iterate_loc],transaction_cost_cashcrop_sum_subsidy_b_grid[iterate_loc],transaction_cost_worker_sum_subsidy_b_grid[iterate_loc],c_M_worker_sum_subsidy_b_grid[iterate_loc],c_M_staple_sum_subsidy_b_grid[iterate_loc],c_M_cashcrop_sum_subsidy_b_grid[iterate_loc]
    ,MPX_mean_log_subsidy_b_grid[iterate_loc], MPX_mean_staples_S_log_subsidy_b_grid[iterate_loc],MPX_mean_cashcrop_log_subsidy_b_grid[iterate_loc]
    , APland_mean_log_subsidy_b_grid[iterate_loc],APland_mean_cashcrop_log_subsidy_b_grid[iterate_loc], APland_mean_staples_S_log_subsidy_b_grid[iterate_loc],var_APland_subsidy_b_grid[iterate_loc],var_APland_cashcrop_subsidy_b_grid[iterate_loc],var_APland_staples_S_subsidy_b_grid[iterate_loc],
    c_S_W_fine_subsidy_b_grid[:,:,iterate_loc],c_B_W_fine_subsidy_b_grid[:,:,iterate_loc],c_M_W_fine_subsidy_b_grid[:,:,iterate_loc],c_S_S_fine_subsidy_b_grid[:,:,iterate_loc],c_B_S_fine_subsidy_b_grid[:,:,iterate_loc],c_M_S_fine_subsidy_b_grid[:,:,iterate_loc],c_S_B_fine_subsidy_b_grid[:,:,iterate_loc],c_B_B_fine_subsidy_b_grid[:,:,iterate_loc],c_M_B_fine_subsidy_b_grid[:,:,iterate_loc]) = details_model(prices_subsidy_b_grid[:,iterate_loc],parameters_tmp,2,moments,1.0,foreign_supply_capital_subsidy_b);
end
for iterate_loc = 1:no_taus
    welfare_subsidy_b_grid[iterate_loc] = sum(stat_distr_subsidy_b_grid[:,no_taus] .* (exp.((welfare_val_subsidy_b_grid[:,iterate_loc] - welfare_val_subsidy_b_grid[:,no_taus]) * (1.0 - Baseline_parameter.β) ) ))  - 1; # With balanced budget
end

welfare_subsidy_b_grid_alt = copy(welfare_subsidy_b_grid);
for iterate_loc = 1:no_taus
    welfare_subsidy_b_grid_alt[iterate_loc] = (1 - Baseline_parameter.β)* (sum(stat_distr_subsidy_b_grid[:,iterate_loc] .* welfare_val_subsidy_b_grid[:,iterate_loc] ) - sum(stat_distr_subsidy_b_grid[:,no_taus].*welfare_val_subsidy_b_grid[:,no_taus])  ); # With balanced budget
end

welfare_subsidy_b_grid_real = copy(welfare_subsidy_b_grid);

V_saved_b_grid_reshaped=reshape(V_saved_b_grid,Baseline_parameter.ns_fine*3,no_taus)
for iterate_loc = 1:no_taus-1
    welfare_subsidy_b_grid_real[iterate_loc] = sum(stat_distr_subsidy_b_grid[:, no_taus] .* (exp.((V_saved_b_grid_reshaped[:, iterate_loc] - V_saved_b_grid_reshaped[:, no_taus]) * (1.0 - Baseline_parameter.β)))) - 1 # With balanced budget
end

welfare_subsidy_b_grid_real_alt = copy(welfare_subsidy_b_grid_real);
for iterate_loc = 1:no_taus-1
    welfare_subsidy_b_grid_real_alt[iterate_loc] = (1 - Baseline_parameter.β) * (sum(stat_distr_subsidy_b_grid[:, iterate_loc] .* V_saved_b_grid_reshaped[:, iterate_loc]) - sum(stat_distr_subsidy_b_grid[:, no_taus] .* V_saved_b_grid_reshaped[:, no_taus]) ) # With balanced budget

end

welfare_subsidy_b_grid_alt_stat = copy(welfare_subsidy_b_grid);
for iterate_loc = 1:no_taus
    welfare_subsidy_b_grid_alt_stat[iterate_loc] = (1 - Baseline_parameter.β)* (sum(stat_distr_subsidy_b_grid[:,no_taus] .* welfare_val_subsidy_b_grid[:,iterate_loc] ) - sum(stat_distr_subsidy_b_grid[:,no_taus].*welfare_val_subsidy_b_grid[:,no_taus])  ); # With balanced budget
end

welfare_subsidy_b_grid_real_alt_stat = copy(welfare_subsidy_b_grid_real);
for iterate_loc = 1:no_taus-1
    welfare_subsidy_b_grid_real_alt_stat[iterate_loc] = (1 - Baseline_parameter.β) * (sum(stat_distr_subsidy_b_grid[:, no_taus] .* V_saved_b_grid_reshaped[:, iterate_loc]) - sum(stat_distr_subsidy_b_grid[:, no_taus] .* V_saved_b_grid_reshaped[:, no_taus]) ) # With balanced budget

end

welfare_subsidy_b_grid_chg_stat = copy(welfare_subsidy_b_grid_real);

for iterate_loc = 1:no_taus
    welfare_subsidy_b_grid_chg_stat[iterate_loc] = sum(stat_distr_subsidy_b_grid[:,iterate_loc] .* (exp.((welfare_val_subsidy_b_grid[:,iterate_loc] - welfare_val_subsidy_b_grid[:,no_taus]) * (1.0 - Baseline_parameter.β) ) ))  - 1; # With balanced budget
end
welfare_subsidy_b_grid_real_chg_stat = copy(welfare_subsidy_b_grid_real);
for iterate_loc = 1:no_taus-1
    welfare_subsidy_b_grid_real_chg_stat[iterate_loc] = sum(stat_distr_subsidy_b_grid[:, iterate_loc] .* (exp.((V_saved_b_grid_reshaped[:, iterate_loc] - V_saved_b_grid_reshaped[:, no_taus]) * (1.0 - Baseline_parameter.β)))) - 1 # With balanced budget
end

# cons_difference_subsidy_b_grid =  copy(welfare_subsidy_b_grid_real);
# for iterate_loc = 1:no_taus-1
#     cons_difference_subsidy_b_grid[iterate_loc] =  sum(stat_distr_subsidy_b_grid[:, no_taus] .* reshape(cons_fine_local_subsidy_b_grid[:,:, iterate_loc] ./ cons_fine_local_subsidy_b_grid[:, :,no_taus],Baseline_parameter.ns_fine*3 )) - 1 
# end
# cons_difference_subsidy_b_grid_alt =  copy(welfare_subsidy_b_grid_real);
# for iterate_loc = 1:no_taus-1
#     cons_difference_subsidy_b_grid_alt[iterate_loc] =   (sum(stat_distr_subsidy_b_grid[:,iterate_loc] .*reshape(cons_fine_local_subsidy_b_grid[:,:, iterate_loc] ,Baseline_parameter.ns_fine*3 ) ) -sum(stat_distr_subsidy_b_grid[:,no_taus].*reshape(cons_fine_local_subsidy_b_grid[:, :,no_taus],Baseline_parameter.ns_fine*3 )));
# end


# a_prime_difference_subsidy_b_grid =  copy(welfare_subsidy_b_grid_real);
# for iterate_loc = 1:no_taus-1
#     a_prime_difference_subsidy_b_grid[iterate_loc] =  sum(stat_distr_subsidy_b_grid[:, no_taus] .* reshape(a_prime_fine_local_subsidy_b_grid[:,:, iterate_loc] ./ a_prime_fine_local_subsidy_b_grid[:, :,no_taus],Baseline_parameter.ns_fine*3 )) - 1 
# end

# Nonbalanced government budget
prices_subsidy_nb_grid = [1.50872539725031 1.4673992693527906 1.4273612102888877 1.4002704145147913 1.3805455359154548 1.3577188571208347 1.3385962315372708 1.322423110082058 1.3076290867718414 1.293125145914655 1.2784534233104363 1.2637925719878549 1.2527366493934884 1.2431172420061254 1.2343328779410385 1.2264904912505203 1.2163541462536198 1.2155564755545372 1.2023427553371973 1.1951014336357657 1.1882831767847994; 0.25456229194429497 0.24875978260516052 0.22551493997643357 0.22960314229329182 0.21003896261709787 0.2021581692436379 0.1990863653507355 0.19823000098526858 0.1960044072611596 0.19428033491655666 0.19351766896986927 0.19242431768473547 0.1900474307899898 0.18951339945971896 0.1883546221448267 0.18832326130527738 0.18658139607043173 0.18683106748600964 0.18492789133309823 0.18424657200258904 0.18349666056314162]
 # Use the same grid as for the balanced subsidy
residual_goods_subsidy_nb_grid = ones(6,no_taus);
stat_distr_subsidy_nb_grid = ones(Baseline_parameter.ns_fine*3,no_taus);
cons_fine_local_subsidy_nb_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
a_prime_fine_local_subsidy_nb_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
future_occupation_fine_local_subsidy_nb_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
x_S_S_fine_subsidy_nb_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
x_SC_fine_subsidy_nb_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
x_BC_fine_subsidy_nb_grid = ones(Baseline_parameter.ns_fine,3,no_taus);
coeff_subsidy_nb_grid = ones(Baseline_parameter.ns,3,no_taus);
transaction_cost_loss_subsidy_nb_grid = ones(no_taus);
nominal_GDP_subsidy_nb_grid= ones(no_taus);
welfare_val_subsidy_nb_grid =  ones(Baseline_parameter.ns_fine*3,no_taus);
Import_value_subsidy_nb_grid = ones(no_taus);
Export_value_subsidy_nb_grid = ones(no_taus);
current_worker_pop_subsidy_nb_grid = ones(no_taus);
current_staple_pop_subsidy_nb_grid = ones(no_taus);
current_cashcrop_pop_subsidy_nb_grid = ones(no_taus);
marketable_agr_surplus_share_subsidy_nb_grid = ones(no_taus);
exportshare_cashcrop_subsidy_nb_grid = ones(no_taus);
fraction_model_subsidy_nb_grid= ones(no_taus);
program_spending_subsidy_nb_grid= ones(no_taus);
prod_value_improvement_subsidy_nb_grid= ones(no_taus);
share_selling_increase_subsidy_nb_grid= ones(no_taus);
exp_ratio_model_subsidy_nb_grid= ones(no_taus);
mig_rate_model_subsidy_nb_grid= ones(no_taus);
rural_pop_only_staples_model_subsidy_nb_grid= ones(no_taus);
rural_pop_only_cashcrop_model_subsidy_nb_grid= ones(no_taus);
mean_land_share_to_staples_among_cc_model_subsidy_nb_grid= ones(no_taus);
urban_rural_inc_ratio_model_subsidy_nb_grid= ones(no_taus);
urban_rural_wealth_ratio_model_subsidy_nb_grid= ones(no_taus);
urban_rural_consumption_ratio_model_subsidy_nb_grid= ones(no_taus);
p90_wealth_rural_subsidy_nb_grid= ones(no_taus);
p90_wealth_urban_subsidy_nb_grid= ones(no_taus);
p99_wealth_rural_subsidy_nb_grid= ones(no_taus);
p99_wealth_urban_subsidy_nb_grid= ones(no_taus);
p90_cons_tmp_subsidy_nb_grid= ones(no_taus);
p90_income_tmp_subsidy_nb_grid= ones(no_taus);
p99_cons_tmp_subsidy_nb_grid= ones(no_taus);
p99_income_tmp_subsidy_nb_grid= ones(no_taus);
staple_productivity_subsidy_nb_grid= ones(no_taus);
cashcrop_productivity_subsidy_nb_grid= ones(no_taus);
manuf_productivity_subsidy_nb_grid= ones(no_taus);
relative_land_to_staples_subsidy_nb_grid= ones(no_taus);
relative_land_to_cashcrop_subsidy_nb_grid= ones(no_taus);
share_constrained_cashcrop_subsidy_nb_grid= ones(no_taus);
var_MPX_staples_S_subsidy_nb_grid= ones(no_taus);
var_MPX_cashcrop_B_subsidy_nb_grid= ones(no_taus);
var_MPX_cashcrop_S_subsidy_nb_grid= ones(no_taus);
share_constrained_staple_subsidy_nb_grid= ones(no_taus);
APG_subsidy_nb_grid= ones(no_taus);
urban_rural_consumption_ratio_model_real_subsidy_nb_grid= ones(no_taus);
aggregate_consumption_subsidy_nb_grid= ones(no_taus);
worker_pop_effective_subsidy_nb_grid= ones(no_taus);
prod_manuf_subsidy_nb_grid= ones(no_taus);
total_entry_cost_subsidy_nb_grid= ones(no_taus);
prod_staple_subsidy_nb_grid= ones(no_taus);
prod_cashcrop_subsidy_nb_grid= ones(no_taus);
input_staple_subsidy_nb_grid= ones(no_taus);
input_cashcrop_subsidy_nb_grid= ones(no_taus);
total_maintenance_cost_subsidy_nb_grid= ones(no_taus);
current_account_residual_subsidy_nb_grid= ones(no_taus);
fraction_cashcrop_suboptimal_model_subsidy_nb_grid = ones(no_taus);
welfare_subsidy_nb_grid= ones(no_taus);
V_saved_b_grid = ones(Baseline_parameter.ns_fine, 3, no_taus);
avg_labor_prod_rural_subsidy_nb_grid= ones(no_taus);
avg_labor_prod_urban_subsidy_nb_grid= ones(no_taus);
avg_agri_prod_rural_subsidy_nb_grid= ones(no_taus);
avg_agri_prod_urban_subsidy_nb_grid= ones(no_taus);
var_MPX_cashcrop_subsidy_nb_grid= ones(no_taus);
var_MPX_subsidy_nb_grid= ones(no_taus);
TFP_subsidy_nb_grid= ones(no_taus);
YL_manuf_subsidy_nb_grid= ones(no_taus);
YL_agr_subsidy_nb_grid= ones(no_taus);
coeff_var_labor_prod_rural_subsidy_nb_grid= ones(no_taus);
coeff_var_labor_prod_urban_subsidy_nb_grid= ones(no_taus);
coeff_var_agri_prod_rural_subsidy_nb_grid= ones(no_taus);
coeff_var_agri_prod_urban_subsidy_nb_grid= ones(no_taus);
p90_wealth_subsidy_nb_grid= ones(no_taus);
p99_wealth_subsidy_nb_grid= ones(no_taus);
p90_cons_subsidy_nb_grid_rural= ones(no_taus);
p99_cons_subsidy_nb_grid_rural= ones(no_taus);
p90_cons_subsidy_nb_grid_urban= ones(no_taus);
p99_cons_subsidy_nb_grid_urban= ones(no_taus);
p90_income_subsidy_nb_grid_rural= ones(no_taus);
p99_income_subsidy_nb_grid_rural= ones(no_taus);
p90_income_subsidy_nb_grid_urban= ones(no_taus);
p99_income_subsidy_nb_grid_urban= ones(no_taus);
wealth_of_workers_subsidy_nb_grid= ones(no_taus);
wealth_of_staples_subsidy_nb_grid= ones(no_taus);
wealth_of_cashcrop_subsidy_nb_grid= ones(no_taus);
c_B_worker_sum_subsidy_nb_grid= ones(no_taus);
c_B_staple_sum_subsidy_nb_grid= ones(no_taus);
c_B_cashcrop_sum_subsidy_nb_grid= ones(no_taus);
c_S_worker_sum_subsidy_nb_grid= ones(no_taus);
c_S_staple_sum_subsidy_nb_grid = ones(no_taus);
c_S_cashcrop_sum_subsidy_nb_grid= ones(no_taus);
transaction_cost_staple_sum_subsidy_nb_grid= ones(no_taus);
transaction_cost_cashcrop_sum_subsidy_nb_grid= ones(no_taus);
transaction_cost_worker_sum_subsidy_nb_grid= ones(no_taus);
c_M_worker_sum_subsidy_nb_grid= ones(no_taus);
c_M_staple_sum_subsidy_nb_grid= ones(no_taus);
c_M_cashcrop_sum_subsidy_nb_grid= ones(no_taus);
MPX_mean_log_subsidy_nb_grid= ones(no_taus);
MPX_mean_staples_S_log_subsidy_nb_grid= ones(no_taus);
MPX_mean_cashcrop_log_subsidy_nb_grid= ones(no_taus);
APland_mean_log_subsidy_nb_grid= ones(no_taus);
APland_mean_cashcrop_log_subsidy_nb_grid= ones(no_taus);
APland_mean_staples_S_log_subsidy_nb_grid= ones(no_taus);
var_APland_subsidy_nb_grid= ones(no_taus);
var_APland_cashcrop_subsidy_nb_grid= ones(no_taus);
var_APland_staples_S_subsidy_nb_grid= ones(no_taus);
c_S_W_fine_subsidy_nb_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_B_W_fine_subsidy_nb_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_M_W_fine_subsidy_nb_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_S_S_fine_subsidy_nb_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_B_S_fine_subsidy_nb_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_M_S_fine_subsidy_nb_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_S_B_fine_subsidy_nb_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_B_B_fine_subsidy_nb_grid= ones(Baseline_parameter.ns_fine,3,no_taus);
c_M_B_fine_subsidy_nb_grid= ones(Baseline_parameter.ns_fine,3,no_taus);

for iterate_loc = 1:no_taus
    parameters_tmp = copy(Baseline_parameter);
    parameters_tmp.τ_S = τ_grid[iterate_loc];
    println("Populate for " ,τ_grid[iterate_loc], "subsidy rate")
    (residual_goods_subsidy_nb_grid[:,iterate_loc], stat_distr_subsidy_nb_grid[:,iterate_loc], cons_fine_local_subsidy_nb_grid[:,:,iterate_loc], a_prime_fine_local_subsidy_nb_grid[:,:,iterate_loc],
    future_occupation_fine_local_subsidy_nb_grid[:,:,iterate_loc],x_S_S_fine_subsidy_nb_grid[:,:,iterate_loc],x_SC_fine_subsidy_nb_grid[:,:,iterate_loc],x_BC_fine_subsidy_nb_grid[:,:,iterate_loc], 
    coeff_subsidy_nb_grid[:,:,iterate_loc],  transaction_cost_loss_subsidy_nb_grid[iterate_loc],nominal_GDP_subsidy_nb_grid[iterate_loc],welfare_val_subsidy_nb_grid[:,iterate_loc],
    Import_value_subsidy_nb_grid[iterate_loc],Export_value_subsidy_nb_grid[iterate_loc],current_worker_pop_subsidy_nb_grid[iterate_loc],current_staple_pop_subsidy_nb_grid[iterate_loc],
    current_cashcrop_pop_subsidy_nb_grid[iterate_loc], marketable_agr_surplus_share_subsidy_nb_grid[iterate_loc],exportshare_cashcrop_subsidy_nb_grid[iterate_loc],
    fraction_model_subsidy_nb_grid[iterate_loc],program_spending_subsidy_nb_grid[iterate_loc],prod_value_improvement_subsidy_nb_grid[iterate_loc],share_selling_increase_subsidy_nb_grid[iterate_loc],
    exp_ratio_model_subsidy_nb_grid[iterate_loc],mig_rate_model_subsidy_nb_grid[iterate_loc],rural_pop_only_staples_model_subsidy_nb_grid[iterate_loc],
    rural_pop_only_cashcrop_model_subsidy_nb_grid[iterate_loc],mean_land_share_to_staples_among_cc_model_subsidy_nb_grid[iterate_loc],urban_rural_inc_ratio_model_subsidy_nb_grid[iterate_loc],
    urban_rural_wealth_ratio_model_subsidy_nb_grid[iterate_loc],urban_rural_consumption_ratio_model_subsidy_nb_grid[iterate_loc],p90_wealth_rural_subsidy_nb_grid[iterate_loc],
    p90_wealth_urban_subsidy_nb_grid[iterate_loc],p99_wealth_rural_subsidy_nb_grid[iterate_loc],p99_wealth_urban_subsidy_nb_grid[iterate_loc],p90_cons_tmp_subsidy_nb_grid[iterate_loc],
    p90_income_tmp_subsidy_nb_grid[iterate_loc],p99_cons_tmp_subsidy_nb_grid[iterate_loc],p99_income_tmp_subsidy_nb_grid[iterate_loc],staple_productivity_subsidy_nb_grid[iterate_loc],
    cashcrop_productivity_subsidy_nb_grid[iterate_loc],manuf_productivity_subsidy_nb_grid[iterate_loc],relative_land_to_staples_subsidy_nb_grid[iterate_loc],
    relative_land_to_cashcrop_subsidy_nb_grid[iterate_loc],share_constrained_cashcrop_subsidy_nb_grid[iterate_loc],var_MPX_staples_S_subsidy_nb_grid[iterate_loc],
    var_MPX_cashcrop_B_subsidy_nb_grid[iterate_loc],var_MPX_cashcrop_S_subsidy_nb_grid[iterate_loc],share_constrained_staple_subsidy_nb_grid[iterate_loc],APG_subsidy_nb_grid[iterate_loc],
    urban_rural_consumption_ratio_model_real_subsidy_nb_grid[iterate_loc],aggregate_consumption_subsidy_nb_grid[iterate_loc],
    worker_pop_effective_subsidy_nb_grid[iterate_loc],prod_manuf_subsidy_nb_grid[iterate_loc],total_entry_cost_subsidy_nb_grid[iterate_loc],prod_staple_subsidy_nb_grid[iterate_loc],prod_cashcrop_subsidy_nb_grid[iterate_loc],input_staple_subsidy_nb_grid[iterate_loc],input_cashcrop_subsidy_nb_grid[iterate_loc],
    total_maintenance_cost_subsidy_nb_grid[iterate_loc],current_account_residual_subsidy_nb_grid[iterate_loc],fraction_cashcrop_suboptimal_model_subsidy_nb_grid[iterate_loc],V_saved_b_grid[:,:,iterate_loc],
    avg_labor_prod_rural_subsidy_nb_grid[iterate_loc],avg_labor_prod_urban_subsidy_nb_grid[iterate_loc],avg_agri_prod_rural_subsidy_nb_grid[iterate_loc],avg_agri_prod_urban_subsidy_nb_grid[iterate_loc],
    var_MPX_cashcrop_subsidy_nb_grid[iterate_loc] ,var_MPX_subsidy_nb_grid[iterate_loc] ,TFP_subsidy_nb_grid[iterate_loc] ,YL_manuf_subsidy_nb_grid[iterate_loc]  , 
    YL_agr_subsidy_nb_grid[iterate_loc] ,coeff_var_labor_prod_rural_subsidy_nb_grid[iterate_loc] ,coeff_var_labor_prod_urban_subsidy_nb_grid[iterate_loc] ,
    coeff_var_agri_prod_rural_subsidy_nb_grid[iterate_loc] , coeff_var_agri_prod_urban_subsidy_nb_grid[iterate_loc] ,
    p90_wealth_subsidy_nb_grid[iterate_loc] ,p99_wealth_subsidy_nb_grid[iterate_loc] ,p90_cons_subsidy_nb_grid_rural[iterate_loc] ,p99_cons_subsidy_nb_grid_rural[iterate_loc] ,p90_cons_subsidy_nb_grid_urban[iterate_loc],p99_cons_subsidy_nb_grid_urban[iterate_loc],p90_income_subsidy_nb_grid_rural[iterate_loc] ,
    p99_income_subsidy_nb_grid_rural[iterate_loc],p90_income_subsidy_nb_grid_urban[iterate_loc],p99_income_subsidy_nb_grid_urban[iterate_loc],
    wealth_of_workers_subsidy_nb_grid[iterate_loc] ,wealth_of_staples_subsidy_nb_grid[iterate_loc] ,wealth_of_cashcrop_subsidy_nb_grid[iterate_loc] ,
    c_B_worker_sum_subsidy_nb_grid[iterate_loc],c_B_staple_sum_subsidy_nb_grid[iterate_loc],c_B_cashcrop_sum_subsidy_nb_grid[iterate_loc],c_S_worker_sum_subsidy_nb_grid[iterate_loc],c_S_staple_sum_subsidy_nb_grid[iterate_loc] ,c_S_cashcrop_sum_subsidy_nb_grid[iterate_loc],
    transaction_cost_staple_sum_subsidy_nb_grid[iterate_loc],transaction_cost_cashcrop_sum_subsidy_nb_grid[iterate_loc],transaction_cost_worker_sum_subsidy_nb_grid[iterate_loc],c_M_worker_sum_subsidy_nb_grid[iterate_loc],c_M_staple_sum_subsidy_nb_grid[iterate_loc],c_M_cashcrop_sum_subsidy_nb_grid[iterate_loc]
    ,MPX_mean_log_subsidy_nb_grid[iterate_loc], MPX_mean_staples_S_log_subsidy_nb_grid[iterate_loc],MPX_mean_cashcrop_log_subsidy_nb_grid[iterate_loc]
    , APland_mean_log_subsidy_nb_grid[iterate_loc],APland_mean_cashcrop_log_subsidy_nb_grid[iterate_loc], APland_mean_staples_S_log_subsidy_nb_grid[iterate_loc],var_APland_subsidy_nb_grid[iterate_loc],var_APland_cashcrop_subsidy_nb_grid[iterate_loc],var_APland_staples_S_subsidy_nb_grid[iterate_loc],
    c_S_W_fine_subsidy_nb_grid[:,:,iterate_loc],c_B_W_fine_subsidy_nb_grid[:,:,iterate_loc],c_M_W_fine_subsidy_nb_grid[:,:,iterate_loc],c_S_S_fine_subsidy_nb_grid[:,:,iterate_loc],c_B_S_fine_subsidy_nb_grid[:,:,iterate_loc],c_M_S_fine_subsidy_nb_grid[:,:,iterate_loc],c_S_B_fine_subsidy_nb_grid[:,:,iterate_loc],c_B_B_fine_subsidy_nb_grid[:,:,iterate_loc],c_M_B_fine_subsidy_nb_grid[:,:,iterate_loc]) = details_model(prices_subsidy_nb_grid[:,iterate_loc],parameters_tmp,2,moments,0.0,foreign_supply_capital_subsidy_b);
    #iterate_loc = iterate_loc + 1;
end
for iterate_loc = 1:no_taus
    welfare_subsidy_nb_grid[iterate_loc] = sum(stat_distr_subsidy_nb_grid[:,no_taus] .* (exp.((welfare_val_subsidy_nb_grid[:,iterate_loc] - welfare_val_subsidy_nb_grid[:,no_taus]) * (1.0 - Baseline_parameter.β) ) ))  - 1; # With balanced budget
end

welfare_subsidy_nb_grid_alt = copy(welfare_subsidy_nb_grid);
for iterate_loc = 1:no_taus
    welfare_subsidy_nb_grid_alt[iterate_loc] = (1 - Baseline_parameter.β)* (sum(stat_distr_subsidy_nb_grid[:,iterate_loc] .* welfare_val_subsidy_nb_grid[:,iterate_loc] ) - sum(stat_distr_subsidy_nb_grid[:,no_taus].*welfare_val_subsidy_nb_grid[:,no_taus])  ); # With balanced budget
end

welfare_subsidy_nb_grid_real = copy(welfare_subsidy_nb_grid);

V_saved_b_grid_reshaped=reshape(V_saved_b_grid,Baseline_parameter.ns_fine*3,no_taus)
for iterate_loc = 1:no_taus-1
    welfare_subsidy_nb_grid_real[iterate_loc] = sum(stat_distr_subsidy_nb_grid[:, no_taus] .* (exp.((V_saved_b_grid_reshaped[:, iterate_loc] - V_saved_b_grid_reshaped[:, no_taus]) * (1.0 - Baseline_parameter.β)))) - 1 # With balanced budget
end

welfare_subsidy_nb_grid_real_alt = copy(welfare_subsidy_nb_grid_real);
for iterate_loc = 1:no_taus-1
    welfare_subsidy_nb_grid_real_alt[iterate_loc] = (1 - Baseline_parameter.β) * (sum(stat_distr_subsidy_nb_grid[:, iterate_loc] .* V_saved_b_grid_reshaped[:, iterate_loc]) - sum(stat_distr_subsidy_nb_grid[:, no_taus] .* V_saved_b_grid_reshaped[:, no_taus]) ) # With balanced budget

end

welfare_subsidy_nb_grid_alt_stat = copy(welfare_subsidy_nb_grid);
for iterate_loc = 1:no_taus
    welfare_subsidy_nb_grid_alt_stat[iterate_loc] = (1 - Baseline_parameter.β)* (sum(stat_distr_subsidy_nb_grid[:,no_taus] .* welfare_val_subsidy_nb_grid[:,iterate_loc] ) - sum(stat_distr_subsidy_nb_grid[:,no_taus].*welfare_val_subsidy_nb_grid[:,no_taus])  ); # With balanced budget
end

welfare_subsidy_nb_grid_real_alt_stat = copy(welfare_subsidy_nb_grid_real);
for iterate_loc = 1:no_taus-1
    welfare_subsidy_nb_grid_real_alt_stat[iterate_loc] = (1 - Baseline_parameter.β) * (sum(stat_distr_subsidy_nb_grid[:, no_taus] .* V_saved_b_grid_reshaped[:, iterate_loc]) - sum(stat_distr_subsidy_nb_grid[:, no_taus] .* V_saved_b_grid_reshaped[:, no_taus]) ) # With balanced budget

end

welfare_subsidy_nb_grid_chg_stat = copy(welfare_subsidy_nb_grid_real);

for iterate_loc = 1:no_taus
    welfare_subsidy_nb_grid_chg_stat[iterate_loc] = sum(stat_distr_subsidy_nb_grid[:,iterate_loc] .* (exp.((welfare_val_subsidy_nb_grid[:,iterate_loc] - welfare_val_subsidy_nb_grid[:,no_taus]) * (1.0 - Baseline_parameter.β) ) ))  - 1; # With balanced budget
end
welfare_subsidy_nb_grid_real_chg_stat = copy(welfare_subsidy_nb_grid_real);
for iterate_loc = 1:no_taus-1
    welfare_subsidy_nb_grid_real_chg_stat[iterate_loc] = sum(stat_distr_subsidy_nb_grid[:, iterate_loc] .* (exp.((V_saved_b_grid_reshaped[:, iterate_loc] - V_saved_b_grid_reshaped[:, no_taus]) * (1.0 - Baseline_parameter.β)))) - 1 # With balanced budget
end
# plot!(τ_grid,100*)


# plot!(τ_grid,100*welfare_subsidy_b_grid_alt)
# plot!(τ_grid,100*welfare_subsidy_b_grid_real_alt)

# plot(τ_grid,100*welfare_subsidy_b_grid_real)
# plot!(τ_grid,100*p90_cons_tmp_subsidy_b_grid)
# plot!(τ_grid,10*var_MPX_subsidy_b_grid)
# plot!(τ_grid,100*cons_difference_subsidy_b_grid)
# plot!(τ_grid,100*avg_agri_prod_rural_subsidy_b_grid./(avg_agri_prod_rural_subsidy_b_grid[no_taus]).-100)
# plot!(τ_grid,100*avg_labor_prod_urban_subsidy_b_grid./(avg_labor_prod_urban_subsidy_b_grid[no_taus]).-100)
# plot!(τ_grid,APG_subsidy_b_grid)
# plot(τ_grid,100*wealth_of_workers_subsidy_b_grid)
# plot(τ_grid,100*wealth_of_staples_subsidy_b_grid)
# plot(τ_grid,100*fraction_model_subsidy_b_grid)
# plot(τ_grid,100*transaction_cost_loss_subsidy_b_grid)
# plot(τ_grid,100*a_prime_difference_subsidy_b_grid)
# plot!(τ_grid,100*p90_wealth_subsidy_b_grid)
# plot(τ_grid,100*fraction_cashcrop_suboptimal_model_subsidy_b_grid)
# plot(τ_grid,[100*welfare_subsidy_b_grid,100*welfare_subsidy_b_grid_real,100*welfare_subsidy_b_grid_alt,100*welfare_subsidy_b_grid_real_alt]
# , label=["Laszlo expected" "Laszlo current" "Karol expected" "Karol current"],legend=:bottomright ,
# linewidth = 2,linestyle = [:solid :dash],ylims = [-10.0,5.0], xlabel = "τ_S",
# ylabel = "Welfare change",
# grid = false,
# tickfontsize = 14,xguidefontsize=12,yguidefontsize=12,legendfontsize=12,fontfamily="Times_Roman")
# savefig("Welfare_measures.pdf")

# plot(τ_grid,[100*movmean(welfare_subsidy_b_grid,4),100*movmean(welfare_subsidy_b_grid_real,4),100*movmean(welfare_subsidy_b_grid_alt,4),100*movmean(welfare_subsidy_b_grid_real_alt,4)]
# , label=["Laszlo expected" "Laszlo current" "Karol expected" "Karol current"],legend=:bottomright ,
# linewidth = 2,linestyle = [:solid :dash],ylims = [-10.0,5.0], xlabel = "τ_S",
# ylabel = "Welfare change",
# grid = false,
# tickfontsize = 14,xguidefontsize=12,yguidefontsize=12,legendfontsize=12,fontfamily="Times_Roman")
# savefig("Welfare_measures_smoothed.pdf")

# plot(τ_grid,[100*welfare_subsidy_b_grid,100*welfare_subsidy_b_grid_real,100*welfare_subsidy_b_grid_alt_stat,100*welfare_subsidy_b_grid_real_alt_stat]
# , label=["Laszlo expected" "Laszlo current" "Karol expected" "Karol current"],legend=:bottomright ,
# linewidth = 2,linestyle = [:solid :dash],ylims = [-10.0,5.0], xlabel = "τ_S",
# ylabel = "Welfare change",
# grid = false,
# tickfontsize = 14,xguidefontsize=12,yguidefontsize=12,legendfontsize=12,fontfamily="Times_Roman")
# savefig("Welfare_measures_stat.pdf")

# plot(τ_grid,[100*welfare_subsidy_b_grid_chg_stat,100*welfare_subsidy_b_grid_real_chg_stat,100*welfare_subsidy_b_grid_alt,100*welfare_subsidy_b_grid_real_alt]
# , label=["Laszlo expected" "Laszlo current" "Karol expected" "Karol current"],legend=:bottomright ,
# linewidth = 2,linestyle = [:solid :dash],ylims = [-10.0,5.0], xlabel = "τ_S",
# ylabel = "Welfare change",
# grid = false,
# tickfontsize = 14,xguidefontsize=12,yguidefontsize=12,legendfontsize=12,fontfamily="Times_Roman")
# savefig("Welfare_measures_chg_distr.pdf")

# plot(τ_grid,movmean(100*welfare_subsidy_b_grid_alt,4))
# plot!(τ_grid,100*welfare_subsidy_b_grid_alt)
# plot(τ_grid,100*cons_difference_subsidy_b_grid)
# plot!(τ_grid,100*cons_difference_subsidy_b_grid_alt)
# savefig("Figure_welfare.pdf")

# plot!(τ_grid,100* sum(abs.(residual_goods_subsidy_b_grid), dims = 1)')
# plot!(τ_grid,100* maximum(abs.(residual_goods_subsidy_b_grid), dims = 1)')
# plot(τ_grid,100*current_worker_pop_subsidy_b_grid)
# plot(τ_grid,10*prices_subsidy_b_grid[3,:])
# plot(τ_grid,100*prices_subsidy_b_grid[2,:])
# sum((stat_distr_sub_b_grid[:,iterate_loc]*exp(welfare_val_sub_b_grid[:,iterate_loc])) / sum(stat_distr_sub_b_grid[:,no_taus]*exp(welfare_val_sub_b_grid[:,no_taus]))) * (1-beta)
# plot(τ_grid,100* residual_goods_subsidy_b_grid[2,:])

# prices_subsidy_b_grid_smooth = copy(prices_subsidy_b_grid);
# prices_subsidy_b_grid_smooth[2,1:(end-1)] = movmean(prices_subsidy_b_grid[2,1:(end-1)],9);
# prices_subsidy_b_grid = copy(prices_subsidy_b_grid_smooth);
# # Consider people 
# sum(stat_distr_subsidy_b_grid[:,no_taus] .* (exp.((welfare_val_subsidy_b_grid[:,iterate_loc] - welfare_val_subsidy_b_grid[:,no_taus]) * (1.0 - Baseline_parameter.β) ) ))  - 1; # With balanced budget

# 
#No QS + recalibrated F_W + no subsidy equilibrium
# prices_no_QS_recab_no_subsidy = [ 1.190752722671664,
# 0.16670260063915554]
# no_QS_recab_no_subsidy_parameter = copy(Baseline_parameter);
# no_QS_recab_no_subsidy_parameter.τ_S=-0;
# no_QS_recab_no_subsidy_parameter.Q_S=0;
# no_QS_recab_no_subsidy_parameter.F_W = 305.0

# (residual_goods_no_QS_recab_no_subsidy, stat_distr_no_QS_recab_no_subsidy, cons_fine_local_no_QS_recab_no_subsidy, a_prime_fine_local_no_QS_recab_no_subsidy,future_occupation_fine_local_no_QS_recab_no_subsidy,x_S_S_fine_no_QS_recab_no_subsidy,x_SC_fine_no_QS_recab_no_subsidy,x_BC_fine_no_QS_recab_no_subsidy, coeff_no_QS_recab_no_subsidy,
# transaction_cost_loss_no_QS_recab_no_subsidy,nominal_GDP_no_QS_recab_no_subsidy,welfare_val_no_QS_recab_no_subsidy,Import_value_no_QS_recab_no_subsidy,Export_value_no_QS_recab_no_subsidy,current_worker_pop_no_QS_recab_no_subsidy,current_staple_pop_no_QS_recab_no_subsidy,current_cashcrop_pop_no_QS_recab_no_subsidy,
# marketable_agr_surplus_share_no_QS_recab_no_subsidy,exportshare_cashcrop_no_QS_recab_no_subsidy,
# fraction_model_no_QS_recab_no_subsidy,program_spending_no_QS_recab_no_subsidy,prod_value_improvement_no_QS_recab_no_subsidy,share_selling_increase_no_QS_recab_no_subsidy,exp_ratio_model_no_QS_recab_no_subsidy,mig_rate_model_no_QS_recab_no_subsidy,rural_pop_only_staples_model_no_QS_recab_no_subsidy,rural_pop_only_cashcrop_model_no_QS_recab_no_subsidy,
# mean_land_share_to_staples_among_cc_model_no_QS_recab_no_subsidy,urban_rural_inc_ratio_model_no_QS_recab_no_subsidy,urban_rural_wealth_ratio_model_no_QS_recab_no_subsidy,urban_rural_consumption_ratio_model_no_QS_recab_no_subsidy,
# p90_wealth_rural_no_QS_recab_no_subsidy,p90_wealth_urban_no_QS_recab_no_subsidy,p99_wealth_rural_no_QS_recab_no_subsidy,p99_wealth_urban_no_QS_recab_no_subsidy,p90_cons_tmp_no_QS_recab_no_subsidy,p90_income_tmp_no_QS_recab_no_subsidy,p99_cons_tmp_no_QS_recab_no_subsidy,p99_income_tmp_no_QS_recab_no_subsidy,
# staple_productivity_no_QS_recab_no_subsidy,cashcrop_productivity_no_QS_recab_no_subsidy,manuf_productivity_no_QS_recab_no_subsidy,relative_land_to_staples_no_QS_recab_no_subsidy,relative_land_to_cashcrop_no_QS_recab_no_subsidy,share_constrained_cashcrop_no_QS_recab_no_subsidy,var_MPX_staples_S_no_QS_recab_no_subsidy,var_MPX_cashcrop_B_no_QS_recab_no_subsidy,var_MPX_cashcrop_S_no_QS_recab_no_subsidy,
# share_constrained_staple_no_QS_recab_no_subsidy,APG_no_QS_recab_no_subsidy,urban_rural_consumption_ratio_model_real_no_QS_recab_no_subsidy,aggregate_consumption_no_QS_recab_no_subsidy,
# worker_pop_effective_no_QS_recab_no_subsidy,prod_manuf_no_QS_recab_no_subsidy,total_entry_cost_no_QS_recab_no_subsidy,prod_staple_no_QS_recab_no_subsidy,prod_cashcrop_no_QS_recab_no_subsidy,input_staple_no_QS_recab_no_subsidy,input_cashcrop_no_QS_recab_no_subsidy,total_maintenance_cost_no_QS_recab_no_subsidy,
# current_account_residual_no_QS_recab_no_subsidy,fraction_cashcrop_suboptimal_model_no_QS_recab_no_subsidy,V_saved_no_QS_recab_no_subsidy
# ,avg_labor_prod_rural_no_QS_recab_no_subsidy,avg_labor_prod_urban_no_QS_recab_no_subsidy,avg_agri_prod_rural_no_QS_recab_no_subsidy,avg_agri_prod_urban_no_QS_recab_no_subsidy
# ,var_MPX_cashcrop_no_QS_recab_no_subsidy,var_MPX_no_QS_recab_no_subsidy,TFP_no_QS_recab_no_subsidy,YL_manuf_no_QS_recab_no_subsidy , YL_agr_no_QS_recab_no_subsidy,coeff_var_labor_prod_rural_no_QS_recab_no_subsidy,coeff_var_labor_prod_urban_no_QS_recab_no_subsidy,coeff_var_agri_prod_rural_no_QS_recab_no_subsidy, coeff_var_agri_prod_urban_no_QS_recab_no_subsidy
# ,
# p90_wealth_no_QS_recab_no_subsidy,p99_wealth_no_QS_recab_no_subsidy,p90_cons_no_QS_recab_no_subsidy_rural,p99_cons_no_QS_recab_no_subsidy_rural,p90_cons_no_QS_recab_no_subsidy_urban,p99_cons_no_QS_recab_no_subsidy_urban,p90_income_no_QS_recab_no_subsidy_rural,
# p99_income_no_QS_recab_no_subsidy_rural,p90_income_no_QS_recab_no_subsidy_urban,p99_income_no_QS_recab_no_subsidy_urban,
# wealth_of_workers_no_QS_recab_no_subsidy,wealth_of_staples_no_QS_recab_no_subsidy,wealth_of_cashcrop_no_QS_recab_no_subsidy,
# c_B_worker_sum_no_QS_recab_no_subsidy,c_B_staple_sum_no_QS_recab_no_subsidy,c_B_cashcrop_sum_no_QS_recab_no_subsidy,c_S_worker_sum_no_QS_recab_no_subsidy,c_S_staple_sum_no_QS_recab_no_subsidy ,c_S_cashcrop_sum_no_QS_recab_no_subsidy,
# transaction_cost_staple_sum_no_QS_recab_no_subsidy,transaction_cost_cashcrop_sum_no_QS_recab_no_subsidy,transaction_cost_worker_sum_no_QS_recab_no_subsidy,c_M_worker_sum_no_QS_recab_no_subsidy,c_M_staple_sum_no_QS_recab_no_subsidy,c_M_cashcrop_sum_no_QS_recab_no_subsidy
# )  = details_model(prices_no_QS_recab_no_subsidy,no_QS_recab_no_subsidy_parameter,2,moments,0.0,foreign_supply_capital_subsidy_b);


# #    Subsidy equilibrium with balanced budget + No QS + recalibrated F_W 
# prices_no_QS_recab_subsidy_b =  [1.5163159754906252,
# 0.24936579281247012,
# 0.1755991002351221]
# no_QS_recab_parameter = copy(Baseline_parameter);
# no_QS_recab_parameter.Q_S=0.0;
# no_QS_recab_parameter.F_W = 305.0
# (residual_goods_no_QS_recab_subsidy_b, stat_distr_no_QS_recab_subsidy_b, cons_fine_local_no_QS_recab_subsidy_b, a_prime_fine_local_no_QS_recab_subsidy_b,future_occupation_fine_local_no_QS_recab_subsidy_b,x_S_S_fine_no_QS_recab_subsidy_b,x_SC_fine_no_QS_recab_subsidy_b,x_BC_fine_no_QS_recab_subsidy_b, coeff_no_QS_recab_subsidy_b,
# transaction_cost_loss_no_QS_recab_subsidy_b,nominal_GDP_no_QS_recab_subsidy_b,welfare_val_no_QS_recab_subsidy_b,Import_value_no_QS_recab_subsidy_b,Export_value_no_QS_recab_subsidy_b,current_worker_pop_no_QS_recab_subsidy_b,current_staple_pop_no_QS_recab_subsidy_b,current_cashcrop_pop_no_QS_recab_subsidy_b,
# marketable_agr_surplus_share_no_QS_recab_subsidy_b,exportshare_cashcrop_no_QS_recab_subsidy_b,
# fraction_model_no_QS_recab_subsidy_b,program_spending_no_QS_recab_subsidy_b,prod_value_improvement_no_QS_recab_subsidy_b,share_selling_increase_no_QS_recab_subsidy_b,exp_ratio_model_no_QS_recab_subsidy_b,mig_rate_model_no_QS_recab_subsidy_b,rural_pop_only_staples_model_no_QS_recab_subsidy_b,rural_pop_only_cashcrop_model_no_QS_recab_subsidy_b,
# mean_land_share_to_staples_among_cc_model_no_QS_recab_subsidy_b,urban_rural_inc_ratio_model_no_QS_recab_subsidy_b,urban_rural_wealth_ratio_model_no_QS_recab_subsidy_b,urban_rural_consumption_ratio_model_no_QS_recab_subsidy_b,
# p90_wealth_rural_no_QS_recab_subsidy_b,p90_wealth_urban_no_QS_recab_subsidy_b,p99_wealth_rural_no_QS_recab_subsidy_b,p99_wealth_urban_no_QS_recab_subsidy_b,p90_cons_tmp_no_QS_recab_subsidy_b,p90_income_tmp_no_QS_recab_subsidy_b,p99_cons_tmp_no_QS_recab_subsidy_b,p99_income_tmp_no_QS_recab_subsidy_b,
# staple_productivity_no_QS_recab_subsidy_b,cashcrop_productivity_no_QS_recab_subsidy_b,manuf_productivity_no_QS_recab_subsidy_b,relative_land_to_staples_no_QS_recab_subsidy_b,relative_land_to_cashcrop_no_QS_recab_subsidy_b,share_constrained_cashcrop_no_QS_recab_subsidy_b,var_MPX_staples_S_no_QS_recab_subsidy_b,var_MPX_cashcrop_B_no_QS_recab_subsidy_b,var_MPX_cashcrop_S_no_QS_recab_subsidy_b,
# share_constrained_staple_no_QS_recab_subsidy_b,APG_no_QS_recab_subsidy_b,urban_rural_consumption_ratio_model_real_no_QS_recab_subsidy_b,aggregate_consumption_no_QS_recab_subsidy_b,
# worker_pop_effective_no_QS_recab_subsidy_b,prod_manuf_no_QS_recab_subsidy_b,total_entry_cost_no_QS_recab_subsidy_b,prod_staple_no_QS_recab_subsidy_b,prod_cashcrop_no_QS_recab_subsidy_b,input_staple_no_QS_recab_subsidy_b,input_cashcrop_no_QS_recab_subsidy_b,
# total_maintenance_cost_no_QS_recab_subsidy_b,current_account_residual_no_QS_recab_subsidy_b,fraction_cashcrop_suboptimal_model_no_QS_recab_subsidy_b,V_saved_no_QS_recab_subsidy_b
# ,avg_labor_prod_rural_no_QS_recab_subsidy_b,avg_labor_prod_urban_no_QS_recab_subsidy_b,avg_agri_prod_rural_no_QS_recab_subsidy_b,avg_agri_prod_urban_no_QS_recab_subsidy_b,
# var_MPX_cashcrop_no_QS_recab_subsidy_b ,var_MPX_no_QS_recab_subsidy_b ,TFP_no_QS_recab_subsidy_b ,YL_manuf_no_QS_recab_subsidy_b  , 
# YL_agr_no_QS_recab_subsidy_b ,coeff_var_labor_prod_rural_no_QS_recab_subsidy_b ,coeff_var_labor_prod_urban_no_QS_recab_subsidy_b ,
# coeff_var_agri_prod_rural_no_QS_recab_subsidy_b , coeff_var_agri_prod_urban_no_QS_recab_subsidy_b,
# p90_wealth_no_QS_recab_subsidy_b,p99_wealth_no_QS_recab_subsidy_b,p90_cons_no_QS_recab_subsidy_b_rural,p99_cons_no_QS_recab_subsidy_b_rural,p90_cons_no_QS_recab_subsidy_b_urban,p99_cons_no_QS_recab_subsidy_b_urban,p90_income_no_QS_recab_subsidy_b_rural,
# p99_income_no_QS_recab_subsidy_b_rural,p90_income_no_QS_recab_subsidy_b_urban,p99_income_no_QS_recab_subsidy_b_urban,
# wealth_of_workers_no_QS_recab_subsidy_b,wealth_of_staples_no_QS_recab_subsidy_b,wealth_of_cashcrop_no_QS_recab_subsidy_b,
# c_B_worker_sum_no_QS_recab_subsidy_b,c_B_staple_sum_no_QS_recab_subsidy_b,c_B_cashcrop_sum_no_QS_recab_subsidy_b,c_S_worker_sum_no_QS_recab_subsidy_b,c_S_staple_sum_no_QS_recab_subsidy_b ,c_S_cashcrop_sum_no_QS_recab_subsidy_b,
# transaction_cost_staple_sum_no_QS_recab_subsidy_b,transaction_cost_cashcrop_sum_no_QS_recab_subsidy_b,transaction_cost_worker_sum_no_QS_recab_subsidy_b,c_M_worker_sum_no_QS_recab_subsidy_b,c_M_staple_sum_no_QS_recab_subsidy_b,c_M_cashcrop_sum_no_QS_recab_subsidy_b
# )  = details_model(prices_no_QS_recab_subsidy_b,no_QS_recab_parameter,2,moments,1.0,foreign_supply_capital_subsidy_b);
